namespace = ck_geroian_events

## Coalition War Events
ck_geroian_events.0001 = { ### Coalition info for invader
	type = character_event
	title = ck_geroian_events.0001.t
	desc = ck_geroian_events.0001.desc
	theme = war
	right_portrait = {
		character = root
		animation = worry
	}
	override_background = { reference = study }
	
	immediate = {
		scope:defender = {
			save_scope_as = geroiandefenderloc
		}
	}
	
	option = {
		name = ck_geroian_events.0001.a
		custom_tooltip = ck_geroian_events.0001.a.tt
	}
}
ck_geroian_events.0002 = { ### Coalition info for defender
	type = character_event
	title = ck_geroian_events.0002.t
	desc = ck_geroian_events.0002.desc
	theme = war
	right_portrait = {
		character = root
		animation = personality_bold
	}
	override_background = { reference = wilderness }
	
	immediate = {
		scope:attacker = {
			save_scope_as = geroianattackerloc
		}
	}
	
	
	option = {
		name = ck_geroian_events.0002.a
		custom_tooltip = ck_geroian_events.0002.a.tt
	}
}
ck_geroian_events.0003 = { ### Joined Geroian Coalition
	type = letter_event
	opening = ck_geroian_events.0003.opening
	sender = scope:recipient
	desc = ck_geroian_events.0003.desc
	option = {
		name = ck_geroian_events.0003.a
	}
}
ck_geroian_events.0004 = { ### Declined Geroian Coalition
	type = letter_event
	opening = ck_geroian_events.0004.opening
	sender = scope:recipient
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					scope:recipient = {
						scope:recipient = {
							opinion = {
								target = scope:actor
								value >= -10
							}
						}
					}
				}
				desc = ck_geroian_events.0004.desc.a
			}
			desc = ck_geroian_events.0004.desc.b
		}
	}
	immediate = {
		scope:actor = {
			capital_county = {
				save_scope_as = defendercapitalloc
			}
		}
	}
	
	option = {
		name = ck_geroian_events.0004.a
	}
}
ck_geroian_events.0005 = { ### Geroian support randomizer #REMINDER - DISABLE IT FOR AEKEKARTALS
	type = character_event
	hidden = yes
	
	immediate = {
		random_list = {
			2 = {
				modifier = {
					factor = 0
					any_courtier = {
						has_character_flag = geroian_commoners_leader
					}
				}
				trigger_event = {
					id = ck_geroian_events.0006 # Commoners host join the fight
					days = { 2 7 }
				}
				every_character_war = {
					limit = {
						has_variable = geroian_invasion_var
						NOT = {
							has_variable = geroian_assistance_decided_var
						}
					}
					set_variable = geroian_assistance_yet_to_decide_var
				}
			}
			2 = {
				modifier = {
					factor = 0
					has_character_modifier = extorted_burghers_modifier
				}
				trigger_event = {
					id = ck_geroian_events.0007 # Burghers sponsor a host
					days = { 2 7 }
				}
				every_character_war = {
					limit = {
						has_variable = geroian_invasion_var
						NOT = {
							has_variable = geroian_assistance_decided_var
						}
					}
					set_variable = geroian_assistance_yet_to_decide_var
				}
			}
			2 = {
				modifier = {
					factor = 0
					has_character_modifier = extorted_minor_nobility_modifier
				}
				trigger_event = {
					id = ck_geroian_events.0008 # Landowners sponsor a host
					days = { 2 7 }
				}
				every_character_war = {
					limit = {
						has_variable = geroian_invasion_var
						NOT = {
							has_variable = geroian_assistance_decided_var
						}
					}
					set_variable = geroian_assistance_yet_to_decide_var
				}
			}
			2 = {
				modifier = {
					factor = 0
					any_courtier = {
						has_character_flag = geroian_warrior_monk
					}
				}
				trigger_event = {
					id = ck_geroian_events.0009 # Warrior monk arrives with a host
					days = { 2 7 }
				}
				every_character_war = {
					limit = {
						has_variable = geroian_invasion_var
						NOT = {
							has_variable = geroian_assistance_decided_var
						}
					}
					set_variable = geroian_assistance_yet_to_decide_var
				}
			}
			2 = {
				modifier = {
					factor = 0
					has_character_modifier = extorted_burghers_modifier
				}
				trigger_event = {
					id = ck_geroian_events.0010 # Burghers give monetary assitance
					days = { 2 7 }
				}
				every_character_war = {
					limit = {
						has_variable = geroian_invasion_var
						NOT = {
							has_variable = geroian_assistance_decided_var
						}
					}
					set_variable = geroian_assistance_yet_to_decide_var
				}
			}
			2 = {
				trigger_event = {
					id = ck_geroian_events.0011 # Commoners rally up
					days = { 2 7 }
				}
				every_character_war = {
					limit = {
						has_variable = geroian_invasion_var
						NOT = {
							has_variable = geroian_assistance_decided_var
						}
					}
					set_variable = geroian_assistance_yet_to_decide_var
				}
			}
			2 = { 
				every_character_war = { # Nothing ever happens
					limit = {
						has_variable = geroian_invasion_var
						NOR = {
							has_variable = geroian_assistance_decided_var
							has_variable = geroian_assistance_yet_to_decide_var
						}
					}
					set_variable = geroian_assistance_decided_var
				}
			}
		}
	}
}
ck_geroian_events.0006 = { ### Commoners host join the fight
	type = character_event
	title = ck_geroian_events.0006.t
	desc = ck_geroian_events.0006.desc
	theme = war
	left_portrait = {
		character = scope:geroian_commoner
		animation = marshal_axe
	}
	right_portrait = {
		character = root
		animation = personality_bold
	}
	override_background = { reference = farmland }
	
	immediate = {
		every_character_war = {
			limit = {
				has_variable = geroian_assistance_yet_to_decide_var
			}
			save_scope_as = geroian_war
		}
		create_character = {
			age = { 30 50 }
			gender = male
			trait = brave
			trait = organizer
			trait = peasant_leader
			random_traits_list = {
				education_martial_3 = { }
				education_martial_2 = { }
			}
			faith = root.faith
			culture = root.culture
			location = root.capital_province
			dynasty = none
			prowess = { 12 15 }
			martial = { 8 12 }
			save_scope_as = geroian_commoner
		}
		random_held_title = {
			limit = {
				tier = tier_county
				title_province = {
					geographical_region = region_geroia
				}
			}
			save_scope_as = commoners_county
		}
	}
	option = { # Accept their help
		name = ck_geroian_events.0006.a
		
		custom_tooltip = {
			text = geroian_commoner_host_tt
			spawn_army = {
				war = scope:geroian_war
				men_at_arms = {
					type = geroian_pikemen_1
					men = 400
				}
				men_at_arms = {
					type = geroian_light_infantry
					men = 300
				}
				location = root.capital_province
				inheritable = no
				name = geroian_commoner_host_army
			}
		}
		add_courtier = scope:geroian_commoner
		scope:geroian_commoner = {
			add_character_flag = geroian_commoners_leader
		}
		scope:commoners_county = {
			add_county_modifier = {
				modifier = commoners_fight_modifier
				years = 3
			}
		}
		stress_impact = {
			arrogant = medium_stress_impact_gain
		}
		
		scope:geroian_war = {
			remove_variable = geroian_assistance_yet_to_decide_var
			set_variable = geroian_assistance_decided_var
		}
		
		ai_chance = {
			base = 10
			modifier = {
				add = -10 
				has_trait = arrogant
			}
		}
	}
	option = { #I don't need your help
		name = ck_geroian_events.0006.b
		
		add_prestige = 100
		scope:geroian_commoner = {
			silent_disappearance_effect = yes
		}
		stress_impact = {
			arrogant = medium_stress_loss
		}
		
		scope:geroian_war = {
			remove_variable = geroian_assistance_yet_to_decide_var
			set_variable = geroian_assistance_decided_var
		}
		
		ai_chance = {
			base = 0
			modifier = {
				add = 10 
				has_trait = arrogant
			}
		}
	}
}
ck_geroian_events.0007 = { ### Burghers sponsor a host
	type = character_event
	title = ck_geroian_events.0007.t
	desc = ck_geroian_events.0007.desc
	theme = war
	right_portrait = {
		character = root
		animation = personality_bold
	}
	override_background = { reference = market_west }
	
	immediate = {
		every_character_war = {
			limit = {
				has_variable = geroian_assistance_yet_to_decide_var
			}
			save_scope_as = geroian_war
		}
		random_held_title = {
			limit = {
				tier = tier_county
				title_province = {
					geographical_region = region_geroia
				}
			}
			save_scope_as = burghers_county
		}
	}
	option = { # Accept their help
		name = ck_geroian_events.0007.a
		
		custom_tooltip = {
			text = geroian_burgher_host_tt
			spawn_army = {
				war = scope:geroian_war
				men_at_arms = {
					type = geroian_pikemen_2
					men = 200
				}
				men_at_arms = {
					type = geroian_crossbowmen_2
					men = 200
				}
				location = root.capital_province
				inheritable = no
				name = geroian_burgher_host_army
			}
		}
		scope:burghers_county = {
			add_county_modifier = {
				modifier = burghers_tax_cut_modifier
				years = 3
			}
		}
		stress_impact = {
			arrogant = medium_stress_impact_gain
		}
		
		scope:geroian_war = {
			remove_variable = geroian_assistance_yet_to_decide_var
			set_variable = geroian_assistance_decided_var
		}
		
		ai_chance = {
			base = 10
			modifier = {
				add = -10 
				has_trait = arrogant
			}
		}
	}
	option = { # You will help me, whether you like it or not
		name = ck_geroian_events.0007.c
		
		add_tyranny = 10
		custom_tooltip = {
			text = geroian_burgher_host_tt
			spawn_army = {
				war = scope:geroian_war
				men_at_arms = {
					type = geroian_pikemen_2
					men = 200
				}
				men_at_arms = {
					type = geroian_crossbowmen_2
					men = 200
				}
				location = root.capital_province
				inheritable = no
				name = geroian_burgher_host_army
			}
		}
		add_prestige = major_prestige_loss
		add_dread = 15
		add_character_modifier = {
			modifier = extorted_burghers_modifier
			years = 5
		}
		
		stress_impact = {
			wrathful = medium_stress_loss
			greedy = minor_stress_loss
		}
		scope:geroian_war = {
			remove_variable = geroian_assistance_yet_to_decide_var
			set_variable = geroian_assistance_decided_var
		}
		
		ai_chance = {
			base = 0
			modifier = {
				add = 20 
				has_trait = wrathful
				NOR = {
					has_trait = just
					has_trait = temperate
					has_trait = compassionate
					has_trait = patient
				}
			}
			modifier = {
				add = 7 
				has_trait = greedy
				NOR = {
					has_trait = just
					has_trait = temperate
					has_trait = compassionate
					has_trait = patient
				}
			}
		}
	}
	option = { #I don't need your help
		name = ck_geroian_events.0007.b
		
		add_prestige = 100
		stress_impact = {
			arrogant = medium_stress_loss
		}
		
		scope:geroian_war = {
			remove_variable = geroian_assistance_yet_to_decide_var
			set_variable = geroian_assistance_decided_var
		}
		
		ai_chance = {
			base = 0
			modifier = {
				add = 10 
				has_trait = arrogant
			}
		}
	}
}
ck_geroian_events.0008 = { ### Landowners sponsor a host
	type = character_event
	title = ck_geroian_events.0008.t
	desc = ck_geroian_events.0008.desc
	theme = war
	right_portrait = {
		character = root
		animation = personality_bold
	}
	override_background = { reference = farmland }
	
	immediate = {
		every_character_war = {
			limit = {
				has_variable = geroian_assistance_yet_to_decide_var
			}
			save_scope_as = geroian_war
		}
		random_held_title = {
			limit = {
				tier = tier_county
				title_province = {
					geographical_region = region_geroia
				}
			}
			save_scope_as = landowners_county
		}
	}
	option = { # Accept their help
		name = ck_geroian_events.0008.a
		
		custom_tooltip = {
			text = geroian_landowner_host_tt
			spawn_army = {
				war = scope:geroian_war
				men_at_arms = {
					type = geroian_light_cavalry
					men = 300
				}
				men_at_arms = {
					type = geroian_horse_archers
					men = 200
				}
				location = root.capital_province
				inheritable = no
				name = geroian_landowner_host_army
			}
		}
		scope:landowners_county = {
			add_county_modifier = {
				modifier = landowners_privileges_modifier
				years = 3
			}
		}
		stress_impact = {
			arrogant = medium_stress_impact_gain
		}
		
		scope:geroian_war = {
			remove_variable = geroian_assistance_yet_to_decide_var
			set_variable = geroian_assistance_decided_var
		}
		
		ai_chance = {
			base = 10
			modifier = {
				add = -10 
				has_trait = arrogant
			}
		}
	}
	option = { #You will help me whether you like it or not
		name = ck_geroian_events.0008.c
		
		add_tyranny = 10
		custom_tooltip = {
			text = geroian_landowner_host_tt
			spawn_army = {
				war = scope:geroian_war
				men_at_arms = {
					type = geroian_light_cavalry
					men = 300
				}
				men_at_arms = {
					type = geroian_horse_archers
					men = 200
				}
				location = root.capital_province
				inheritable = no
				name = geroian_landowner_host_army
			}
		}
		add_prestige = major_prestige_loss
		add_dread = 15
		add_character_modifier = {
			modifier = extorted_minor_nobility_modifier
			years = 5
		}
		
		stress_impact = {
			wrathful = medium_stress_loss
			greedy = minor_stress_loss
		}
		scope:geroian_war = {
			remove_variable = geroian_assistance_yet_to_decide_var
			set_variable = geroian_assistance_decided_var
		}
		
		ai_chance = {
			base = 0
			modifier = {
				add = 20 
				has_trait = wrathful
				NOR = {
					has_trait = just
					has_trait = temperate
					has_trait = compassionate
					has_trait = patient
				}
			}
			modifier = {
				add = 7 
				has_trait = greedy
				NOR = {
					has_trait = just
					has_trait = temperate
					has_trait = compassionate
					has_trait = patient
				}
			}
		}
	}
	option = { #I don't need your help
		name = ck_geroian_events.0008.b
		
		add_prestige = 100
		stress_impact = {
			arrogant = medium_stress_loss
		}
		
		scope:geroian_war = {
			remove_variable = geroian_assistance_yet_to_decide_var
			set_variable = geroian_assistance_decided_var
		}
		
		ai_chance = {
			base = 0
			modifier = {
				add = 10 
				has_trait = arrogant
			}
		}
	}
}
ck_geroian_events.0009 = { ### Warrior monk arrives with his host
	type = character_event
	title = ck_geroian_events.0009.t
	desc = ck_geroian_events.0009.desc
	theme = war
	left_portrait = {
		character = scope:geroian_monk
		animation = marshal_mace
	}
	right_portrait = {
		character = root
		animation = personality_bold
	}
	override_background = { reference = wilderness_mountains }
	
	immediate = {
		every_character_war = {
			limit = {
				has_variable = geroian_assistance_yet_to_decide_var
			}
			save_scope_as = geroian_war
		}
		create_character = {
			age = { 40 60 }
			gender = male
			trait = brave
			trait = organizer
			trait = zealous
			trait = order_member
			random_traits_list = {
				education_martial_3 = { }
				education_martial_4 = { }
			}
			faith = root.faith
			culture = root.culture
			location = root.capital_province
			dynasty = none
			prowess = { 11 17 }
			martial = { 9 12 }
			save_scope_as = geroian_monk
		}
	}
	option = { # Accept his help
		name = ck_geroian_events.0009.a
		
		custom_tooltip = {
			text = geroian_monk_host_tt
			spawn_army = {
				war = scope:geroian_war
				men_at_arms = {
					type = geroian_pikemen_2
					men = 500
				}
				men_at_arms = {
					type = geroian_light_infantry
					men = 500
				}
				location = root.capital_province
				inheritable = no
				name = geroian_monk_host_army
			}
		}
		add_courtier = scope:geroian_monk
		scope:geroian_monk = {
			add_character_flag = geroian_warrior_monk
		}
		stress_impact = {
			arrogant = medium_stress_impact_gain
		}
		
		scope:geroian_war = {
			remove_variable = geroian_assistance_yet_to_decide_var
			set_variable = geroian_assistance_decided_var
		}
		
		ai_chance = {
			base = 10
			modifier = {
				add = -10 
				has_trait = arrogant
			}
		}
	}
	option = { #I don't need your help
		name = ck_geroian_events.0009.b
		
		add_prestige = 100
		add_piety = -100
		scope:geroian_commoner = {
			silent_disappearance_effect = yes
		}
		stress_impact = {
			arrogant = medium_stress_loss
		}
		
		scope:geroian_war = {
			remove_variable = geroian_assistance_yet_to_decide_var
			set_variable = geroian_assistance_decided_var
		}
		
		ai_chance = {
			base = 0
			modifier = {
				add = 10 
				has_trait = arrogant
			}
		}
	}
}
ck_geroian_events.0010 = { ### Burghers give monetary assitance
	type = character_event
	title = ck_geroian_events.0010.t
	desc = ck_geroian_events.0010.desc
	theme = war
	right_portrait = {
		character = root
		animation = interested
	}
	override_background = { reference = council_chamber }
	
	immediate = {
		every_character_war = {
			limit = {
				has_variable = geroian_assistance_yet_to_decide_var
			}
			save_scope_as = geroian_war
		}
	}
	option = { # Accept their help
		name = ck_geroian_events.0010.a
		
		add_gold = 200
		add_character_modifier = {
			modifier = burghers_aid_modifier
			months = 9
		}
		
		stress_impact = {
			arrogant = medium_stress_impact_gain
		}
		
		scope:geroian_war = {
			remove_variable = geroian_assistance_yet_to_decide_var
			set_variable = geroian_assistance_decided_var
		}
		
		ai_chance = {
			base = 10
			modifier = {
				add = -10 
				has_trait = arrogant
			}
		}
	}
	option = { #I don't need your help
		name = ck_geroian_events.0010.b
		
		add_prestige = 100
		stress_impact = {
			arrogant = medium_stress_loss
		}
		
		scope:geroian_war = {
			remove_variable = geroian_assistance_yet_to_decide_var
			set_variable = geroian_assistance_decided_var
		}
		
		ai_chance = {
			base = 0
			modifier = {
				add = 10 
				has_trait = arrogant
			}
		}
	}
}
ck_geroian_events.0011 = { ### Commoners rally up
	type = character_event
	title = ck_geroian_events.0011.t
	desc = ck_geroian_events.0011.desc
	theme = war
	right_portrait = {
		character = root
		animation = war_over_win
	}
	override_background = { reference = farmland }
	
	immediate = {
		every_character_war = {
			limit = {
				has_variable = geroian_assistance_yet_to_decide_var
			}
			save_scope_as = geroian_war
		}
	}
	option = { # Accept their help
		name = ck_geroian_events.0011.a
		
		add_character_modifier = {
			modifier = commoners_rally_up_modifier
			months = 9
		}
		
		stress_impact = {
			arrogant = medium_stress_impact_gain
		}
		
		scope:geroian_war = {
			remove_variable = geroian_assistance_yet_to_decide_var
			set_variable = geroian_assistance_decided_var
		}
		
		ai_chance = {
			base = 10
			modifier = {
				add = -10 
				has_trait = arrogant
			}
		}
	}
	option = { #I don't need your help
		name = ck_geroian_events.0011.b
		
		add_prestige = 100
		stress_impact = {
			arrogant = medium_stress_loss
		}
		
		scope:geroian_war = {
			remove_variable = geroian_assistance_yet_to_decide_var
			set_variable = geroian_assistance_decided_var
		}
		
		ai_chance = {
			base = 0
			modifier = {
				add = 10 
				has_trait = arrogant
			}
		}
	}
}
## Thonian Unification
ck_geroian_events.0012 = { ### Unification of Thonians - unifier pov
	type = character_event
	title = ck_geroian_events.0012.t
	desc = ck_geroian_events.0012.desc
	theme = realm
	right_portrait = {
		character = root
		animation = personality_bold
	}
	override_background = { reference = wilderness_mountains }
	
	option = {
		name = ck_geroian_events.0012.a
		
		add_prestige = 400
		add_legitimacy = 50
		give_nickname = nick_the_unifier_ck
		
		save_scope_as = thonian_king
		every_player = {
			limit = {
				NOT = {
					this = root
				}
				OR = {
					capital_province ?= {
						geographical_region = region_wineyards
					}
					location = {
						geographical_region = region_wineyards
					}
				}
			}
			trigger_event = ck_geroian_events.0013
		}
	}
}
ck_geroian_events.0013 = { ### Unification of Thonians - outsider pov
	type = character_event
	title = ck_geroian_events.0013.t
	desc = ck_geroian_events.0013.desc
	theme = realm
	right_portrait = {
		character = scope:thonian_king
		animation = personality_bold
	}
	override_background = { reference = wilderness_mountains }
	
	option = {
		name = ck_geroian_events.0013.a
		
	}
}

### Flavor Events ###
# "The Melancholic Ransom Broker" - Broker w/ a bounty on his head
ck_geroian_events.0016 = {
	type = character_event
	title = ck_geroian_events.0016.t
	desc = ck_geroian_events.0016.desc
	theme = realm

	left_portrait = {
		character = scope:root
		animation = personality_rational
	}
	right_portrait = {
		character = scope:geroian_1000_zarminner
		animation = beg
	}
	lower_center_portrait = {
		character = scope:ck_notable_geroia_target
		animation = anger
	}

	override_background = { reference = council_chamber }
	trigger = {
		root.capital_province = {
			geographical_region = region_geroia
		}
		culture = {
			has_cultural_pillar = heritage_geroian
		}
		NOT = { has_global_variable = spawned_zarminner }
	}
	immediate = {
		create_character = {
			template = geroian_events_1000_template
			name = "Zarminner"
			location = root.capital_province
			save_scope_as = geroian_1000_zarminner
			after_creation = {
				add_prestige = 200
				add_gold = 150
			}
		}
		random_ruler = {
			limit = {
				capital_province = {
					geographical_region = region_perassic
				}
				is_ai = yes
				highest_held_title_tier <= tier_duchy
				is_capable_adult = yes
				short_term_gold >= major_gold_value
			}
			add_opinion = {
				target = scope:geroian_1000_zarminner
				modifier = geroian_ransomed_my_family_member
			}
			save_scope_as = ck_notable_geroia_target
		}
		set_global_variable = {
			name = spawned_zarminner
			value = yes
		}
	}

	option = {
		name = ck_geroian_events.0016.a
		stress_impact = {
			just = medium_stress_gain
			greedy = minor_stress_gain
		}
		add_character_modifier = {
			modifier = assisted_ransom_broker
			years = 5
		}
		pay_short_term_gold = {
			target = scope:ck_notable_geroia_target
			gold = calking_geroian_diplo_cost_check
		}
		scope:geroian_1000_zarminner = {
			if = {
				limit = {
					short_term_gold >= 100
				}
				pay_short_term_gold = {
					target = root
					gold = { 25 50 }
				}
			}
			add_opinion = {
				target = root
				modifier = grateful_opinion
				opinion = 50
			}
		}
		custom_tooltip = ck_geroian_events.0016.a_tooltip
	}
	option = {
		name = ck_geroian_events.0016.b
		stress_impact = {
			just = major_stress_loss
			greedy = minor_stress_loss
		}
		add_character_modifier = {
			modifier = captured_ransom_broker
			years = 10
		}
		scope:ck_notable_geroia_target = {
			pay_short_term_gold = {
				target = root
				gold = { 100 200 }
			}
			add_opinion = {
				target = root
				modifier = grateful_opinion
				opinion = 40
			}
		}
		scope:geroian_1000_zarminner = {
			add_opinion = {
				target = root
				modifier = respect_opinion
				opinion = -100
			}
		}
		hard_imprison_character_effect = {
			TARGET = scope:geroian_1000_zarminner
			IMPRISONER = scope:ck_notable_geroia_target
		}
		custom_tooltip = ck_geroian_events.0016.b_tooltip
	}

}
# ck_geroian_events.0017 = { # Merchant of Men (Commented out while WIP

# }
ck_geroian_events.0018 = { # Warrior Monk visits
	type = character_event
	title = ck_geroian_events.0018.t
	desc = ck_geroian_events.0018.desc
	theme = faith

	left_portrait = {
		character = root
		triggered_animation = {
			trigger = {
				root = {
					OR = {
						faith = {
							NOT = {
								has_doctrine = special_doctrine_ascensionist
							}
						}
						culture = {
							NOT = {
								has_cultural_pillar = heritage_geroian
							}
						}
						has_trait = cynical
					}
				}
			}
			animation = personality_cynical
		}
		animation = disbelief
	}
	right_portrait = {
		character = scope:geroian_monk_0018
		animation = personality_zealous
	}

	override_background = { reference = council_chamber }

	trigger = {
		root.capital_province = {
			geographical_region = region_geroia
		}
		is_landed = yes
		any_county_in_region = {
			region = region_geroia
			count = all
			faith = {
				has_doctrine = special_doctrine_ascensionist
			}
			culture = {
				has_cultural_tradition = tradition_warrior_monks
			}
		}
		NOR = {
			has_variable = geroian_0018_cooldown_var
			has_character_flag = geroian_events_0018_unavailable
		}
	}

	immediate = {
		random_realm_county = {
			limit = {
				any_county_province = {
					geographical_region = region_geroia
				}
				culture = {
					has_cultural_pillar = heritage_geroian
					has_cultural_tradition = tradition_warrior_monks
				}
				faith = {
					AND = {
						religion_tag = calradian_religion
						has_doctrine = special_doctrine_ascensionist
					}
				}
			}
			save_scope_as = geroian_0018_county
		}
		# Create the Monk
		create_character = {
			template = geroian_monk
			dynasty = none
			location = root.location
			culture = scope:geroian_0018_county.culture
			faith = scope:geroian_0018_county.faith
			gender_female_chance = root_faith_clergy_gender_female_chance
			save_scope_as = geroian_monk_0018
		}
		scope:geroian_monk_0018 = {
			set_location = root.location
			add_trait = devoted
		}
	}
	# Welcome them in
	option = {
		name = ck_geroian_events.0018.a

		# Stress impact for those of the faith (First 'if' statement) / Not of the faith ('else_if' statement)
		if = {
			limit = {
				root = {
					faith = scope:geroian_monk_0018.faith
				}
			}
			stress_impact = {
				zealous = minor_stress_impact_loss
				cynical = medium_stress_impact_gain
			}
		}
		stress_impact = {
			just = minor_stress_impact_loss
			gregarious = medium_stress_impact_loss
		}
		else_if = {
			limit = {
				root.faith = {
					NOT = {
						this = scope:geroian_monk_0018.faith
					}
				}
			}
			stress_impact = {
				just = minor_stress_impact_loss
				cynical = medium_stress_impact_gain
				zealous = major_stress_impact_loss
				gregarious = medium_stress_impact_loss
			}
		}

		# Increases cultural acceptance if not of the Monk's culture
		if = {
			limit = {
				root.culture = {
					NOT = {
						has_cultural_pillar = heritage_geroian
					}
				}
			}
			root.culture = {
				change_cultural_acceptance = {
					target = scope:geroian_monk_0018.culture
					value = medium_positive_cultural_acceptance
					desc = cultural_acceptance_welcomed_geroian_monk
				}
			}
			add_character_modifier = {
				modifier = respected_senija_non_geroian
				years = 5
			}
		}
		else_if = {
			limit = {
				root.culture = {
					has_cultural_pillar = heritage_geroian
				}
			}
			add_character_modifier = {
				modifier = respected_senija_geroian
				years = 5
			}
			add_piety = medium_piety_gain
		}

		# Remove the 'Pissed Off Monk' character flag
		if = {
			limit = {
				has_character_flag = pissed_off_monk
			}
			remove_character_flag = pissed_off_monk
		}

		# Legitimacy as a ruler
		if = {
			limit = { is_valid_for_legitimacy_change = yes }
			add_legitimacy = medium_legitimacy_gain
		}

		# County Modifiers
		every_sub_realm_county = {
			custom = geroian_counties_tt
			limit = {
				culture = {
					AND = {
						has_cultural_pillar = heritage_geroian
						has_cultural_tradition = tradition_warrior_monks
					}
				}
				faith = {
					AND = {
						religion_tag = calradian_religion
						has_doctrine = special_doctrine_ascensionist
					}
				}
			}
			add_county_modifier = {
				modifier = respected_senija_county
				years = 10
			}
		}

		# Every zealous courtier gains/loss opinion depending on their Mandatist stance
		every_courtier_or_guest = {
			custom = all_zealous_non_geroian
			limit = {
				AND = {
					has_trait = zealous
					faith = {
						NOT = {
							has_doctrine = special_doctrine_ascensionist
						}
					}
				}
			}
			add_opinion = {
				target = root
				modifier = disgusted_opinion
				opinion = -30
			}
		}
		every_courtier_or_guest = {
			custom = all_zealous_geroian
			limit = {
				AND = {
					has_trait = zealous
					faith = {
						has_doctrine = special_doctrine_ascensionist
					}
				}
			}
			add_opinion = {
				target = root
				modifier = respect_opinion
				opinion = 30
			}
		}
		trigger_event = {
			id = ck_geroian_events.0100
			days = { 5 10 }
		}

		# Configure if you can or cannot hire the monk
		hidden_effect = {
			random_list = {
				50 = {
					set_variable = can_hire_monk
				}
				50 = {
					# Nothing
				}
			}
		}
	}
	# Kick the monk out
	option = {
		name = ck_geroian_events.0018.b
		# Stress impact for those of the faith (First 'if' statement) / Not of the faith ('else_if' statement)
		if = {
			limit = {
				root = {
					faith = scope:geroian_0018_county.faith
				}
			}
			stress_impact = {
				just = medium_stress_impact_gain
				zealous = major_stress_impact_gain
				cynical = medium_stress_impact_loss
			}
			add_character_modifier = {
				modifier = disrespected_senija_geroian
				years = 5
			}
			add_piety = -250
		}
		else_if = {
			limit = {
				root.faith = {
					NOT = {
						this = scope:geroian_0018_county.faith
					}
				}
			}
			stress_impact = {
				just = medium_stress_impact_gain
				cynical = medium_stress_impact_loss
				zealous = medium_stress_impact_loss
			}
		}
		
		# Lose opinion with monk
		scope:geroian_monk_0018 = {
			add_opinion = {
				target = root
				modifier = impious_opinion
				opinion = -25
			}
		}


		# County Modifiers
		every_sub_realm_county = {
			custom = geroian_counties_tt
			limit = {
				culture = {
					has_cultural_pillar = heritage_geroian
					has_cultural_tradition = tradition_warrior_monks
				}
				faith = {
					AND = {
						religion_tag = calradian_religion
						has_doctrine = special_doctrine_ascensionist
					}
				}
			}
			add_county_modifier = {
				modifier = disrespected_senija_county
				years = 10
			}
		}
		# Shown as tooltip (resolved in next event)
		random_list = {
			# Chances of Monk declaring a challenge to duel (base of 30). Increases if you share faiths
			25 = {
				custom_tooltip = {
					text = geroian_events_0018_duel_tt
					trigger_event = ck_geroian_events.0102
				}
				modifier = {
					add = 10
					root.faith = {
						has_doctrine = special_doctrine_ascensionist
					}
				}
			}
			75 = {
				custom_tooltip = {
					text = geroian_events_0018_cooldown_tt
					trigger_event = ck_geroian_events.0101
				}
				modifier = {
					add = -10
					root.faith = {
						has_doctrine = special_doctrine_ascensionist
					}
				}
			}
		}

		# Every zealous courtier gains/loss opinion depending on their Mandatist stance
		every_courtier_or_guest = {
			custom = all_zealous_non_geroian
			limit = {
				AND = {
					has_trait = zealous
					faith = {
						NOT = {
							has_doctrine = special_doctrine_ascensionist
						}
					}
				}
			}
			add_opinion = {
				target = root
				modifier = disgusted_opinion
				opinion = 30
			}
		}
		every_courtier_or_guest = {
			custom = all_zealous_geroian
			limit = {
				AND = {
					has_trait = zealous
					faith = {
						has_doctrine = special_doctrine_ascensionist
					}
				}
			}
			add_opinion = {
				target = root
				modifier = respect_opinion
				opinion = -30
			}
		}
	}
}
ck_geroian_events.0019 = { # Piracy Infestation - Caused from unresolved pirate in coastal county after 1.5 years
	type = character_event
	title = ck_geroian_events.0019.t
	desc = ck_geroian_events.0019.desc
	theme = realm

	left_portrait = {
		character = root
		animation = war_over_loss
	}
	right_portrait = {
		character = cp:councillor_marshal
		animation = shame
	}

	override_background = { reference = fp1_beached_longships }
	trigger = {
		root.capital_province = {
			geographical_region = region_geroia
		}
		exists = cp:councillor_marshal
		scope:councillor = cp:councillor_marshal
		NOT = {
			has_character_flag = had_geroian_event_0018_recently
		}
		random_sub_realm_county ?= {
			limit = {
				AND = {
					has_county_modifier = geroian_0018_pirate_activity
					any_county_province = {
						is_coastal = yes
					}
				}
			}
		}
	}
	immediate = {
		cp:councillor_marshal = {
			save_scope_as = marshal
		}
		random_sub_realm_county ?= {
			limit = {
				AND = {
					has_county_modifier = geroian_0018_pirate_activity
					any_county_province = {
						is_coastal = yes
					}
				}
			}
			save_scope_as = pirate_county_geroia
		}
		random_neighboring_county = {
			limit = {
				any_county_province = {
					AND = {
						is_coastal = yes
						geographical_region = region_geroia
					}
				}
				holder = {
					NAND = { 
						top_liege = root.top_liege
						this = root 
					}
				}
			}
			save_scope_as = neighboring_county_geroian
		}
	}

	option = {
		name = ck_geroian_events.0019.a
		custom_tooltip = had_geroian_event_0018_tt
		duel = {
			skill = martial
			value = high_skill_rating
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				custom_tooltip = {
					text = freed_of_pirates_tt
					add_character_flag = {
						flag = had_geroian_event_0018_recently
						years = 30
					}
				}
				custom_tooltip = {
					text = earned_pirate_loot
					add_gold = 70
				}
				scope:pirate_county_geroia = {
					change_county_control = 30
					remove_county_modifier = geroian_0018_pirate_activity
				}
			}
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				custom_tooltip = {
					text = rampaging_pirates_tt
					add_character_flag = {
						flag = had_geroian_event_0018_recently
						years = 30
					}
					trigger_event = {
						id = ck_geroian_events.1002
						days = 60
					}
				}
				scope:pirate_county_geroia = {
					change_county_control = -15
					change_development_level = {
						value = scope:pirate_county_geroia.development_level
						multiply = -0.2
						round = yes
					}
				}
			}
		}

	}

	option = {
		name = ck_geroian_events.0019.b
		custom_tooltip = had_geroian_event_0018_tt.2
		add_prestige = -50
		duel = {
			skill = stewardship
			value = 15
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				remove_short_term_gold = 25
				add_character_modifier = {
					modifier = encouraged_piracy_modifier
				}
				scope:neighboring_county_geroian = {
					add_county_modifier = {
						modifier = geroian_0018_pirate_activity
					}
					holder = {
						add_opinion = {
							target = root
							modifier = geroian_encouraged_piracy
						}
					}
					if = {
						limit = {
							exists = holder.top_liege
						}
						holder.top_liege = {
							add_opinion = {
								target = root
								modifier = geroian_encouraged_piracy
							}
						}
					}
				}
			}
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				custom_tooltip = {
					text = rampaging_pirates_tt
					add_character_flag = {
						flag = had_geroian_event_0018_recently
						years = 30
					}
					trigger_event = {
						id = ck_geroian_events.1002
						days = 60
					}
				}
				scope:pirate_county_geroia = {
					change_county_control = -15
					change_development_level = {
						value = scope:pirate_county_geroia.development_level
						multiply = -0.2
						round = yes
					}
				}
				remove_short_term_gold = 50
			}
		}
	}
}

ck_geroian_events.0100 = { # You invite the Monk in for a small feast. Maybe have a small chance of employing them as a decent stat knight
	type = character_event
	title = ck_geroian_events.0100.t
	theme = faith
	left_portrait = {
		character = root
		animation = drink_goblet
	}
	right_portrait = {
		character = scope:geroian_monk_0018
		animation = drink_goblet
	}

	override_background = { reference = council_chamber }

	desc = {
		desc = ck_geroian_events.0100.desc.prologue
		first_valid = {
			triggered_desc = {
				trigger = {
					root = {
						culture = scope:geroian_monk_0018.culture
						faith = scope:geroian_monk_0018.faith
					}
				}
				desc = ck_geroian_events.0100.desc.geroian.faith.culture
			}
			triggered_desc = {
				trigger = {
					root = {
						NOT = {
							culture = scope:geroian_monk_0018.culture
						}
						faith = scope:geroian_monk_0018.faith
					}
				}
				desc = ck_geroian_events.0100.desc.geroian.faith.notculture
			}
			triggered_desc = {
				trigger = {
					root = {
						culture = scope:geroian_monk_0018.culture
						NOT = {
							faith = scope:geroian_monk_0018.faith
						}
					}
				}
				desc = ck_geroian_events.0100.desc.geroian.notfaith.culture
			}
			desc = ck_geroian_events.0100.desc.geroian.notfaith.notculture
		}
		first_valid = {
			triggered_desc = {
				trigger = {
					has_variable = can_hire_monk
				}
				desc = ck_geroian_events.0100.desc.canhire
			}
		}
		first_valid = {
			triggered_desc = {
				trigger = {
					has_variable = can_hire_monk
				}
			desc = ck_geroian_events.0100.desc.epilogue.canhire
			}
			desc = ck_geroian_events.0100.desc.epilogue
		}
	}
	immediate = {
		if = {
			limit = {
				any_court_position_holder = {
					type = bodyguard_court_position
					count >= 2
					NOT = { this = scope:vassal }
				}
			}
			ordered_court_position_holder = {
				type = bodyguard_court_position
				limit = {
					NOT = { this = scope:vassal }
				}
				order_by = {
					value = 0
					subtract = prowess
				}
				save_scope_as = bodyguard
			}
		}
	}
	# Bid them goodbye (Give a cooldown flag and have a chance of them reappearing)
	option = {
		name = {
			text = {
				first_valid = {
					triggered_desc = {
						trigger = {
							root = {
								has_variable = can_hire_monk
							}
						}
						desc = ck_geroian_events.0100.a.canhire
					}
					triggered_desc = {
						trigger = {
							root = {
								NOT = {
									has_variable = can_hire_monk
								}
							}
						}
						desc = ck_geroian_events.0100.a.canthire
					}
				}
			}
		}
		custom_tooltip = {
			text = geroian_events_0018_cooldown_tt_2
			if = {
				limit = {
					NOT = {
						has_variable = geroian_0018_cooldown_var
					}
				}
				set_variable = {
					name = geroian_0018_cooldown_var
					years = 15
				}
			}
			else = {
				change_variable = {
					name = geroian_0018_cooldown_var
					years = 15
				}
			}
		}
		hidden_effect = {
			scope:geroian_monk_0018 = { # Variable to track if the Monk revisits in the future
				set_variable = {
					name = visited_ruler_geroian
					value = root
				}
			}
		}
	}
	# Invite them to the court (will no longer receive this event)
	option = {
		name = ck_geroian_events.0100.b
		trigger = {
			has_variable = can_hire_monk
		}
		add_courtier = scope:geroian_monk_0018
		hidden_effect = {
			scope:geroian_monk_0018 = {
				set_variable = was_hired_by_ruler
				return_to_court = yes
				add_prestige = medium_prestige_gain
				progress_towards_friend_effect = {
					REASON = friend_hired_body_guard
					CHARACTER = root
					OPINION = 0
				}
			}
			add_character_flag = geroian_events_0018_unavailable # Unable to receive event again for this character
			remove_variable = can_hire_monk # Just to cleanup unused variables
		}
		if = {
			limit = { exists = scope:bodyguard }
			revoke_court_position = {
				recipient = scope:bodyguard
				court_position = bodyguard_court_position
			}
			scope:bodyguard = {
				add_opinion = {
					target = root
					modifier = disappointed_opinion
					opinion = -10
				}
			}
		}
		if = {
			limit = {
				can_appoint_char_to_court_position = {
					CHAR = scope:geroian_monk_0018
					COURT_POS = bodyguard_court_position
				}
			}
			court_position_grant_effect = {
				EMPLOYER = root
				POS = bodyguard
				CANDIDATE = scope:geroian_monk_0018
			}
		}
	}
}

ck_geroian_events.0101 = { # You refuse to entertain the monk and kick him out. He does not fight back. He loses some piety for not challenging you.
	type = character_event
	title = ck_geroian_events.0101.t
	theme = faith
	left_portrait = {
		character = root
		animation = personality_cynical
	}
	right_portrait = {
		character = scope:geroian_monk_0018
		animation = anger
	}

	override_background = { reference = council_chamber }

	desc = {
		desc = ck_geroian_events.0101.desc.prologue
		first_valid = {
		}
		first_valid = {
			triggered_desc = {
				trigger = {
					scope:geroian_monk_0018 = {
						exists = var:visited_ruler_geroian
						var:visited_ruler_geroian = root
					}
				}
				desc = ck_geroian_events.0101.desc.revisit
			}
			triggered_desc = {
				trigger = {
					root = {
						culture = scope:geroian_monk_0018.culture
						faith = scope:geroian_monk_0018.faith
					}
				}
				desc = ck_geroian_events.0101.desc.geroian.faith.culture
			}
			triggered_desc = {
				trigger = {
					root = {
						NOT = {
							culture = scope:geroian_monk_0018.culture
						}
						faith = scope:geroian_monk_0018.faith
					}
				}
				desc = ck_geroian_events.0101.desc.geroian.faith.notculture
			}
			triggered_desc = {
				trigger = {
					root = {
						culture = scope:geroian_monk_0018.culture
						NOT = {
							faith = scope:geroian_monk_0018.faith
						}
					}
				}
				desc = ck_geroian_events.0101.desc.geroian.notfaith.culture
			}
			desc = ck_geroian_events.0101.desc.geroian.notfaith.notculture
		}
		desc = ck_geroian_events.0101.desc.epilogue
	}
	option = {
		name = ck_geroian_events.0101.a

		custom_tooltip = {
			text = geroian_events_0101_cooldown_tt_2
			if = {
				limit = {
					NOT = {
						has_variable = geroian_0018_cooldown_var
					}
				}
				set_variable = {
					name = geroian_0018_cooldown_var
					years = 15
				}
			}
			else = {
				change_variable = {
					name = geroian_0018_cooldown_var
					years = 15
				}
			}
		}
		hidden_effect = {
			scope:geroian_monk_0018 = { # Variable to track if the Monk revisits in the future
				set_variable = {
					name = visited_ruler_geroian
					value = root
				}
			}
			if = {
				limit = {
					NOT = {
						has_character_flag = pissed_off_monk
					}
				}
				add_character_flag = pissed_off_monk
			}
		}
	}
	option = {
		name = ck_geroian_events.0101.b

		hard_imprison_character_effect = {
			TARGET = scope:geroian_monk_0018
			IMPRISONER = root
		}

		if = {
			limit = {
				root.faith = {
					NOT = {
						has_doctrine = special_doctrine_ascensionist
					}
				}
			}
			add_piety = 200
		}
		if = {
			limit = {
				NOT = {
					has_character_flag = pissed_off_monk
				}
			}
			add_character_flag = pissed_off_monk
		}
		add_character_modifier = {
			modifier = imprisoned_holy_warrior
			years = 15
		}
		custom_tooltip = {
			text = no_more_monks_geroia
			add_character_flag = geroian_events_0018_unavailable
		}
	}
}

ck_geroian_events.0102 = { # Monk challenges you to a duel. Can either accept to have guards kill him (he will not go away w/o a fight)
	type = character_event
	title = ck_geroian_events.0102.t
	desc = ck_geroian_events.0102.desc
	theme = faith

	left_portrait = {
		character = root
		animation = shock
	}
	right_portrait = {
		character = scope:geroian_monk_0018
		animation = aggressive_unarmed
	}

	override_background = { reference = council_chamber }

	option = { # Fuck off and get the guards instead / Imprisons the monk
		name = ck_geroian_events.0102.a

		

		custom_tooltip = {
			text = ck_geroian_events.0102.imprison_or_kill_monk
			random_list = {
				60 = {
					send_interface_toast = {
						title = ck_geroian_events.0102.a.imprison
						left_icon = scope:geroian_monk_0018
						hard_imprison_character_effect = {
							TARGET = scope:geroian_monk_0018
							IMPRISONER = root
						}
					}
					add_character_modifier = {
						modifier = imprisoned_holy_warrior
						years = 15
					}
				}
				40 = {
					send_interface_toast = {
						title = ck_geroian_events.0102.a.dies
						left_icon = scope:geroian_monk_0018
						scope:geroian_monk_0018 = {
							death = {
								death_reason = death_slaughtered_by_guards
							}
						}
					}
					add_character_flag = geroian_events_0018_unavailable
					
					send_interface_toast = {
						title = ck_geroian_events.0102.dead_monk_counties
						left_icon = scope:geroian_monk_0018
						# County Modifiers
						every_sub_realm_county = {
							custom = geroian_counties_tt
							limit = {
								culture = {
									has_cultural_pillar = heritage_geroian
									has_cultural_tradition = tradition_warrior_monks
								}
								faith = {
									AND = {
										religion_tag = calradian_religion
										has_doctrine = special_doctrine_ascensionist
									}
								}
							}
							add_county_modifier = {
								modifier = killed_holy_warrior_county
								years = 10
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				root.faith = {
					NOT = {
						has_doctrine = special_doctrine_ascensionist
					}
				}
			}
			add_piety = 200
		}
		if = {
			limit = {
				NOT = {
					has_character_flag = pissed_off_monk
				}
			}
			add_character_flag = pissed_off_monk
		}
		custom_tooltip = {
			text = no_more_monks_geroia
			add_character_flag = geroian_events_0018_unavailable
		}
	}

	option = { # Time to d-d-d-d-dueeeeel
		name = ck_geroian_events.0102.b
		custom_tooltip = ck_geroian_events.0102.b.tt
		configure_start_single_combat_effect = {
			SC_INITIATOR = root
			SC_ATTACKER = scope:geroian_monk_0018
			SC_DEFENDER = root
			FATALITY = default
			FIXED = no
			LOCALE = throne_room
			OUTPUT_EVENT = ck_geroian_events.0103 # Win or Lose
			INVALIDATION_EVENT = single_combat.1006
		}
	}
}

ck_geroian_events.0103 = { # Monk duel outcome
	hidden = yes

	immediate = {
		if = {
			limit = {
				root = scope:sc_victor
			}
			scope:sc_victor = {
				send_interface_toast = {
					title = bp1_yearly.5718.t.win
					left_icon = root
					right_icon = scope:5717_nemesis

					add_prestige = minor_prestige_value
				}
				trigger_event = {
					id = ck_geroian_events.0104
					days = 1
				}
			}
			
		}
		else = {
			send_interface_toast = {
				title = bp1_yearly.5718.t.lose
				left_icon = root
				right_icon = scope:5717_nemesis

				add_prestige = minor_prestige_loss
			}
			trigger_event = {
				id = ck_geroian_events.0105
				days = 1
			}
		}
	}
}

ck_geroian_events.0104 = { # Duel Won
	type = character_event
	title = ck_geroian_events.0103.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					root = {
						exists = var:number_of_victories
						var:number_victories = 1
					}
				}
				desc = ck_geroian_events.0103.desc.victories
			}
			desc = ck_geroian_events.0103.desc
		}
	}
	left_portrait = {
		character = root
		animation = celebrate_sword
	}
	right_portrait = {
		character = scope:geroian_monk_0018
		animation = beg
	}

	immediate = {
		hidden_effect = {
			root = {
				if = {
					limit = {
						NOT = {
							exists = var:number_of_victories
						}
					}
					set_variable = {
						name = number_of_victories
						value = 1
					}
				}
				else_if = {
					limit = {
						exists = var:number_of_victories
						var:number_victories = 0
					}
					set_variable = {
						name = number_of_victories
						value = 1
					}
				}
			}
		}
	}

	theme = faith

	option = { # Let the Monk leave
		name = ck_geroian_events.0103.a

		custom_tooltip = {
			text = geroian_events_0018_cooldown_tt_2
			if = {
				limit = {
					NOT = {
						has_variable = geroian_0018_cooldown_var
					}
				}
				set_variable = {
					name = geroian_0018_cooldown_var
					years = 15
				}
			}
			else = {
				change_variable = {
					name = geroian_0018_cooldown_var
					years = 15
				}
			}
		}
		hidden_effect = {
			scope:geroian_monk_0018 = { # Variable to track if the Monk revisits in the future
				set_variable = {
					name = visited_ruler_geroian
					value = root
				}
			}
		}
	}

	option = {
		name = ck_geroian_events.0103.b
		
		scope:geroian_monk_0018 = {
			death = {
				death_reason = death_ck_piteously_cut_down
				killer = root
			}
		}

		custom_tooltip = {
			text = no_more_monks_geroia
			add_character_flag = geroian_events_0018_unavailable
		}
		# County Modifiers
		every_sub_realm_county = {
			custom = geroian_counties_tt
			limit = {
				culture = {
					has_cultural_pillar = heritage_geroian
					has_cultural_tradition = tradition_warrior_monks
				}
				faith = {
					AND = {
						religion_tag = calradian_religion
						has_doctrine = special_doctrine_ascensionist
					}
				}
			}
			add_county_modifier = {
				modifier = killed_holy_warrior_county
				years = 10
			}
		}
	}
}
ck_geroian_events.0105 = { # Duel Lost
	type = character_event
	title = ck_geroian_events.0104.t
	desc = {
		first_valid = {
			triggered_desc = { 
				trigger = {
					var:body_part_removed = flag:no_more_parts
				}
				desc = ck_geroian_events.0104.desc.no_more
			}
			desc = ck_geroian_events.0104.desc
		}
	}
	theme = faith
	
	left_portrait = {
		character = root
		animation = beg
	}
	right_portrait = {
		character = scope:geroian_monk_0018
		animation = celebrate_sword
	}

	immediate = {
		hidden_effect = {
			root = {
				if = {
					limit = {
						exists = var:number_of_victories
					}
					change_variable = {
						name = number_of_victories
						value = 0
					}
				}
				if = {
					limit = {
						has_trait = one_eyed
						has_character_flag = geroian_0018_lost_eye
						NOR = {
							has_trait = blind
							has_character_flag = geroian_0018_lost_eyes
						}
					}
					change_variable = {
						name = body_part_removed
						value = flag:lost_eyes
					}
				}
			}
			random_list = {
				30 = {
					trigger = {
						NOR = {
							has_trait = disfigured
							NOT = { has_character_flag = geroian_0018_lost_nose }
						}
					}
					root = {
						change_variable = {
							name = body_part_removed
							value = flag:lost_nose
						}
					}
				}
				30 = {
					trigger = {
						NOT = { has_character_flag = geroian_0018_lost_eye }
						NOR = {
							has_trait = blind
							has_trait = one_eyed
						}
					}
					root = {
						change_variable = {
							name = body_part_removed
							value = flag:lost_eye
						}
					}
				}
				20 = {
					trigger = {
						NOT = { has_character_flag = geroian_0018_lost_leg }
						NOT = {
							has_trait = one_legged
						}
					}
					root = {
						change_variable = {
							name = body_part_removed
							value = flag:lost_leg
						}
					}
				}
				10 = {
					trigger = {
						NOT = { has_character_flag = geroian_0018_lost_arm }
						NOT = {
							has_trait = maimed
						}
					}
					root = {
						change_variable = {
							name = body_part_removed
							value = flag:lost_arm
						}
					}
				}
			}
			if = {
				limit = {
					AND = {
						has_trait = blind
						has_trait = maimed
						has_trait = one_legged
						has_trait = disfigured
					}
				}
				root = {
					change_variable = {
						name = body_part_removed
						value = flag:no_more_parts
					}
				}
			}
		}
		add_trait = wounded_2
	}
	option = {
		name = ck_geroian_events.0104.a

		geroian_monk_body_part_effect = yes

		if = {
			limit = {
				AND = {
					has_variable = body_part_removed
					var:body_part_removed = flag:no_more_parts
				}
			}
			custom_tooltip = {
				text = no_more_monks_geroia
				add_character_flag = geroian_events_0018_unavailable
			}
		}
		if = {
			limit = {
				root = {
					faith = scope:geroian_0018_county.faith
				}
			}
			add_piety = -50
		}
	}
	option = {
		name = ck_geroian_events.0104.b
		trigger = {
			NAND = {
				has_variable = body_part_removed
				var:body_part_removed = flag:no_more_parts
			}
		}
		if = {
			limit = {
				root = {
					faith = scope:geroian_0018_county.faith
				}
			}
			add_piety = -100
		}
		duel = {
			skill = martial
			value = 18
			40 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				custom_tooltip = {
					text = monk_close_call
					if = {
						limit = {
							NOT = {
								has_character_flag = monk_close_call
							}
						}
						add_character_flag = monk_close_call
					}
				}
				scope:geroian_monk_0018 = {
					death = {
						death_reason = death_slaughtered_by_guards
					}
				}
				custom_tooltip = {
					text = no_more_monks_geroia
					add_character_flag = geroian_events_0018_unavailable
				}
				if = {
					limit = {
						
					}
				}
				# County Modifiers
				every_sub_realm_county = {
					custom = geroian_counties_tt
					limit = {
						culture = {
							has_cultural_pillar = heritage_geroian
							has_cultural_tradition = tradition_warrior_monks
						}
						faith = {
							AND = {
								religion_tag = calradian_religion
								has_doctrine = special_doctrine_ascensionist
							}
						}
					}
					add_county_modifier = {
						modifier = killed_holy_warrior_county
						years = 10
					}
				}
			}
			60 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				custom_tooltip = ck_geroian_events.0104.b.loss
				geroian_monk_body_part_effect = yes
			}
		}
	}
}


# Misc/Background Events #
ck_geroian_events.1001 = { # Collect Taxes Side Effect - Is the Task That Creates the Pirates 
	hidden = yes

	trigger = {
		exists = cp:councillor_steward
		scope:councillor = cp:councillor_steward
		scope:councillor = {
			stewardship < high_skill_rating
		}
		any_sub_realm_county = {
			steward_task_county_corruption_county_trigger = yes
		}
		NOR = {
			has_character_flag = geroian_event_0018_cooldown
			has_character_flag = had_geroian_event_0018_recently
		}
	}

	weight_multiplier = {
		base = 1
		compare_modifier = {
			target = scope:councillor
			value = stewardship
			multiplier = -0.2
			offset = inverted_high_skill_rating
		}
	}

	immediate = {
		cp:councillor_steward = {
			save_scope_as = active_councillor
		}
		set_variable = {
			name = had_steward_task_side_effect
			value = yes
			days = steward_task_side_effect_cooldown
		}
		random_sub_realm_county = {
			limit = {
				steward_task_county_corruption_county_trigger = yes
				any_county_province = {
					is_coastal = yes
				}
			}
			weight = {
				base = 1
				modifier = {
					add = 5
					holder = root
				}
			}
			save_scope_as = county
		}

		send_interface_message = {
			type = msg_steward_task_bad
			title = steward_task.1001.notification
			desc = {
				triggered_desc = {
					trigger = {
						scope:active_councillor = { stewardship <= average_skill_level }
					}
					desc = task_stewardship_bad_unskilled_notification_tooltip
				}
				triggered_desc = {
					trigger = {
						scope:active_councillor = { stewardship > average_skill_level }
					}
					desc = task_stewardship_bad_skilled_notification_tooltip
				}
			}
			
			left_icon = scope:county
			right_icon = scope:councillor
			tooltip = task_collect_taxes_notification_tooltip

			scope:county = {
				add_county_modifier = {
					modifier = geroian_0018_pirate_activity
					days = steward_task_modifier_duration
				}
				holder = {
					trigger_event = {
						id = ck_geroian_events.0019
						months = { 17 24 }
					}
				}
			}
		}
	}
}
ck_geroian_events.1002 = { # Modifier cleanup
	hidden = yes

	trigger = {
		scope:pirate_county_geroia = {
			has_county_modifier = geroian_0018_pirate_activity
		}
	}

	immediate = {
		scope:pirate_county_geroia = {
			remove_county_modifier = geroian_0018_pirate_activity
		}
	}
}


