imperial_province_cb = { #Calradian heritage, only on de iure calradia, against calradians, one province
	icon = county_expansion
	group = conquest

	combine_into_one = yes
	should_show_war_goal_subview = yes
	mutually_exclusive_titles = { always = yes }

	allowed_for_character = {
		scope:attacker.culture = {
			has_cultural_pillar = heritage_calradian
		}
		NOT = {
			government_has_flag = government_is_landless_adventurer
		}
	}

	allowed_against_character = {
		scope:attacker = {
			ALL_FALSE = {
				top_liege = scope:defender.top_liege
				liege = scope:defender
			}
		}
		scope:defender = {
			culture = {
				has_cultural_pillar = heritage_calradian
			}
		}
	}
	target_titles = neighbor_land
	target_title_tier = county
	ignore_effect = change_title_holder
	
	attacker_score_from_occupation_scale = 150
	attacker_score_from_battles_scale = 150
	defender_score_from_battles_scale = 150

	ai_only_against_neighbors = yes
	
	ai_score_mult = {
		value = 1
	}

	valid_to_start = {
		scope:attacker = {
			is_independent_ruler = yes
		}
		scope:target = {
			empire = title:e_calradian_empire
		}
	}

	allowed_for_character_display_regardless = {
	}

	should_invalidate = {
		NOT = {
			any_in_list = {
				list = target_titles
				any_in_de_jure_hierarchy = {
					tier = tier_county
					holder = {
						OR = {
							this = scope:defender
							target_is_liege_or_above = scope:defender
						}
					}
				}
			}
		}
	}

	on_invalidated_desc = msg_county_conquest_war_invalidated_message
	on_invalidated = {}

	cost = {
		prestige = {
			add = {
				value = 50
				desc = CB_BASE_COST
			}
			add = {
				value = 2.5
				multiply = scope:attacker.realm_size
				desc = CB_REALM_SIZE_COST
				max = 150
			}
			if = {
				limit = {
					scope:attacker = {
						is_ai = yes
					}
				}
				multiply = {
					value = 0.3
					desc = "CB_AI_ATTACKER"
				}
			}
			multiply = common_cb_prestige_cost_multiplier
		}
	}

	on_declaration = {
		on_declared_war = yes
	}

	on_victory_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:attacker = { is_local_player = yes } }
				desc = county_conquest_cb_victory_desc_attacker
			}
			desc = county_conquest_cb_victory_desc
		}
	}

	on_victory = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		# Legitimacy
		add_legitimacy_attacker_victory_effect = yes

		# Influence
		add_influence_attacker_victory_effect = yes

		# EP2 accolade glory gain for winning against higher ranked enemy
		scope:attacker = { accolade_attacker_war_end_glory_gain_low_effect = yes }

		create_title_and_vassal_change = {
			type = conquest
			save_scope_as = change
			add_claim_on_loss = yes
		}

		# Grab the designated county.
		every_in_list = {
			list = target_titles
			change_title_holder = {
				holder = scope:attacker
				change = scope:change
			}
		}

		resolve_title_and_vassal_change = scope:change

		# Prestige Progress for the Attacker
		every_in_list = {
			list = target_titles
			scope:attacker = {
				add_prestige_experience = minor_prestige_value
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker
			FAME_BASE = minor_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		# Truce
		add_truce_attacker_victory_effect = yes

		# FP1: note the victory for future memorialisation via stele (if applicable).
		scope:attacker = { fp1_remember_recent_conquest_victory_effect = yes }
	}

	on_white_peace_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = county_conquest_cb_white_peace_desc_defender
			}
			desc = county_conquest_cb_white_peace_desc
		}
	}

	on_white_peace = {
		scope:attacker = { show_pow_release_message_effect = yes }
		# Prestige loss for the attacker
		scope:attacker = {
			add_prestige = {
				value = minor_prestige_value
				multiply = -1.0
			}
			stress_impact = {
 				ambitious = medium_stress_impact_gain
 				arrogant = medium_stress_impact_gain
 			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker # Not important as the scales are identical
			FAME_BASE = minor_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		scope:defender = {
			stress_impact = {
 				arrogant = medium_stress_impact_gain
 			}
		}

		add_truce_white_peace_effect = yes
	}

	on_defeat_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = county_conquest_cb_defeat_desc_defender
			}
			triggered_desc = {
				trigger = {
					scope:attacker = {
						is_local_player = yes
						has_targeting_faction = yes
					}
				}
				desc = county_conquest_cb_defeat_desc_attacker
			}
			desc = county_conquest_cb_defeat_desc
		}
	}

	on_defeat = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		# Legitimacy
		add_legitimacy_attacker_defeat_effect = yes

		# Influence
		add_influence_attacker_defeat_effect = yes

		# EP2 accolade glory gain for winning against higher ranked enemy
		scope:defender = { accolade_defender_war_end_glory_gain_low_effect = yes }

		# Prestige loss for the attacker
		scope:attacker = {
			pay_short_term_gold_reparations_effect = {
				GOLD_VALUE = 2
			}
			add_prestige = medium_prestige_loss
		}

		# Prestige for Defender
		scope:defender = {
			add_prestige_war_defender_effect = {
				PRESTIGE_VALUE = medium_prestige_value
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:defender
			FAME_BASE = minor_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		add_truce_attacker_defeat_effect = yes

		scope:attacker = {
			save_temporary_scope_as = loser
		}
		on_lost_aggression_war_discontent_loss = yes
	}

	transfer_behavior = transfer

	on_primary_attacker_death = inherit
	on_primary_defender_death = inherit

	attacker_allies_inherit = yes
	defender_allies_inherit = yes

	war_name = "EXPANSION_WAR_NAME"
	war_name_base = "EXPANSION_WAR_NAME_BASE"
	cb_name = "CK_EXPANSION_COUNTY_CB_NAME"

	interface_priority = 83

	use_de_jure_wargoal_only = yes

	attacker_wargoal_percentage = 0.8
	
	max_defender_score_from_occupation = 150
	max_attacker_score_from_occupation = 150
}

imperial_duchy_cb = {
	icon = duchy_expansion
	group = conquest

	combine_into_one = yes
	should_show_war_goal_subview = yes
	mutually_exclusive_titles = { always = yes }
	
	attacker_score_from_occupation_scale = 150
	attacker_score_from_battles_scale = 150
	defender_score_from_battles_scale = 150

	allowed_for_character = {
		scope:attacker.culture = {
			has_cultural_pillar = heritage_calradian
		}
		NOT = {
			government_has_flag = government_is_landless_adventurer
		}
	}

	allowed_against_character = {
		scope:attacker = {
			ALL_FALSE = {
				top_liege = scope:defender.top_liege
				liege = scope:defender
			}
		}
		scope:defender = {
			culture = {
				has_cultural_pillar = heritage_calradian
			}
		}
	}

	target_titles = neighbor_land
	target_title_tier = duchy
	target_de_jure_regions_above = yes
	ignore_effect = change_title_holder

	ai_only_against_neighbors = yes
	
	ai_score_mult = {
		value = 1.5
		if = {
			limit = {
				scope:attacker = {
					has_trait = ambitious
				}
			}
			multiply = 5
		}
		if = {
			limit = {
				scope:attacker = {
					has_trait = ck_militarist
				}
			}
			multiply = 1.5
		}
	}

	valid_to_start = {
		scope:attacker = {
			is_independent_ruler = yes
		}
		scope:target = {
			empire = title:e_calradian_empire
		}
	}

	should_invalidate = {
		NOT = {
			any_in_list = {
				list = target_titles
				any_in_de_jure_hierarchy = {
					tier = tier_county
					holder = {
						target_is_same_character_or_above = scope:defender
					}
				}
			}
		}
	}

	on_invalidated_desc = msg_religious_war_invalidation_region_message

	on_invalidated = {
	}
	
	cost = {
		prestige = {
			add = {
				value = 100
				desc = CB_BASE_COST
			}
			add = {
				value = 5
				multiply = scope:attacker.realm_size
				desc = CB_REALM_SIZE_COST
				max = 500
			}
			if = {
				limit = {
					scope:attacker = {
						is_ai = yes
					}
				}
				multiply = {
					value = 0.3
					desc = "CB_AI_ATTACKER"
				}
			}
			multiply = common_cb_prestige_cost_multiplier
		}
	}

	on_declaration = {
		on_declared_war = yes
	}

	on_victory_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:attacker = { is_local_player = yes } }
				desc = county_conquest_cb_victory_desc_attacker
			}
			desc = county_conquest_cb_victory_desc
		}
	}

	on_victory = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		# Legitimacy
		add_legitimacy_attacker_victory_effect = yes

		# Influence
		add_influence_attacker_victory_effect = yes

		# EP2 accolade glory gain for winning against higher ranked enemy
		scope:attacker = { accolade_attacker_war_end_glory_gain_med_effect = yes }

		create_title_and_vassal_change = {
			type = conquest
			save_scope_as = change
			add_claim_on_loss = yes
		}

		# Go through the dejure hierarchy under target titles, transfer eligible vassals and sieze counties from ineligible ones
		every_in_list = {
			list = target_titles
			custom_tooltip = CONQUEST_CB_TITLE

			expansion_cb_title_transfer = yes
		}

		every_in_list = {
			list = vassals_taken
			change_liege = {
				liege = scope:attacker
				change = scope:change
			}
		}

		every_in_list = {
			list = titles_taken
			change_title_holder = {
				holder = scope:attacker
				change = scope:change
				take_baronies = yes
			}
		}

		resolve_title_and_vassal_change = scope:change

		# Prestige Progress for the Attacker
		every_in_list = {
			list = target_titles
			scope:attacker = {
				add_prestige_experience = medium_prestige_value
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker
			FAME_BASE = medium_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		# Truce
		add_truce_attacker_victory_effect = yes

		# FP1: note the victory for future memorialisation via stele (if applicable).
		scope:attacker = { fp1_remember_recent_conquest_victory_effect = yes }

		if = { # Warning that only counties are changing hands
			limit = {
				any_in_list = {
					list = target_titles
					tier = tier_duchy
				}
			}
			random_in_list = {
				list = target_titles
				limit = { tier = tier_duchy }
				save_scope_as = de_jure_target
			}
		}
		if = {
			limit = {
				any_in_list = {
					list = target_titles
					tier = tier_duchy
					holder = scope:defender
				}
			}
			if = {
				limit = {
					scope:defender = {
						any_held_title = {
							tier = tier_county
							NOT = { target_is_de_jure_liege_or_above = scope:de_jure_target }
						}
					}
				}
				custom_tooltip = conquest_title_not_transferred_tt
			}
			else = { custom_tooltip = conquest_title_destroyed_tt }
		}
		else = {
			if = {
				limit = {
					any_in_list = {
						list = target_titles
						tier = tier_duchy
						is_title_created = yes
					}
				}
				custom_tooltip = conquest_title_usurp_tt
			}
			else = { custom_tooltip = conquest_title_create_tt }
		}
	}

	on_white_peace_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = county_conquest_cb_white_peace_desc_defender
			}
			desc = county_conquest_cb_white_peace_desc
		}
	}

	on_white_peace = {
		scope:attacker = { show_pow_release_message_effect = yes }
		# Prestige loss for the attacker

		# EP2 accolade glory gain for doing pretty good against higher ranked enemy
		scope:defender = { accolade_defender_war_end_glory_gain_low_effect = yes }

		scope:attacker = {
			add_prestige = {
				value = minor_prestige_value
				multiply = -1.0
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker # not impactful as the scale are identical
			FAME_BASE = medium_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}


		add_truce_white_peace_effect = yes
	}

	on_defeat_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = county_conquest_cb_defeat_desc_defender
			}
			triggered_desc = {
				trigger = {
					scope:attacker = {
						is_local_player = yes
						has_targeting_faction = yes
					}
				}
				desc = county_conquest_cb_defeat_desc_attacker
			}
			desc = county_conquest_cb_defeat_desc
		}
	}

	on_defeat = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		# Legitimacy
		add_legitimacy_attacker_defeat_effect = yes

		# Influence
		add_influence_attacker_defeat_effect = yes

		# EP2 accolade glory gain for winning against higher ranked enemy
		scope:defender = { accolade_defender_war_end_glory_gain_med_effect = yes }

		# Prestige loss for the attacker
		scope:attacker = {
			pay_short_term_gold_reparations_effect = {
				GOLD_VALUE = 3
			}
			add_prestige = {
				value = major_prestige_value
				multiply = -1.0
			}
		}

		# Prestige for Defender
		scope:defender = {
			add_prestige_war_defender_effect = {
				PRESTIGE_VALUE = major_prestige_value
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:defender
			FAME_BASE = medium_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		add_truce_attacker_defeat_effect = yes

		scope:attacker = {
			save_temporary_scope_as = loser
		}
		on_lost_aggression_war_discontent_loss = yes
	}

	transfer_behavior = transfer

	on_primary_attacker_death = inherit
	on_primary_defender_death = inherit

	attacker_allies_inherit = yes
	defender_allies_inherit = yes

	war_name = "EXPANSION_WAR_NAME"
	war_name_base = "EXPANSION_WAR_NAME_BASE"
	cb_name = "CK_EXPANSION_DUCHY_CB_NAME"

	interface_priority = 84

	use_de_jure_wargoal_only = yes

	attacker_wargoal_percentage = 0.8
	
	max_defender_score_from_occupation = 150
	max_attacker_score_from_occupation = 150
}
imperial_kingdom_cb = {
	icon = duchy_expansion
	group = conquest

	combine_into_one = yes
	should_show_war_goal_subview = yes
	mutually_exclusive_titles = { always = yes }
	
	attacker_score_from_occupation_scale = 150
	attacker_score_from_battles_scale = 150
	defender_score_from_battles_scale = 150

	allowed_for_character = {
		scope:attacker.culture = {
			has_cultural_pillar = heritage_calradian
		}
		scope:attacker = {
			has_trait = claimant_emperor
		}
		NOT = {
			government_has_flag = government_is_landless_adventurer
		}
	}
	allowed_for_character_display_regardless = {
		# ONLY 5 YEARS
		custom_tooltip = {
			text = imperial_kingdom_cb_cooldown_tt
			scope:attacker = {
				NOT = {
					has_character_flag = started_imperial_kingdom_expansion
				}
			}
		}
	}
	allowed_against_character = {
		scope:attacker = {
			ALL_FALSE = {
				top_liege = scope:defender.top_liege
				liege = scope:defender
			}
		}
		scope:defender = {
			culture = {
				has_cultural_pillar = heritage_calradian
			}
		}
		scope:defender = {
			has_trait = claimant_emperor
		}
	}

	target_titles = neighbor_land
	target_title_tier = kingdom
	target_de_jure_regions_above = yes
	ignore_effect = change_title_holder

	ai_only_against_neighbors = yes
	
	ai_score_mult = {
		value = 1.3
		if = {
			limit = {
				scope:attacker = {
					has_trait = ambitious
				}
			}
			multiply = 5
		}
		if = {
			limit = {
				scope:attacker = {
					has_trait = ck_militarist
				}
			}
			multiply = 1.5
		}
	}

	valid_to_start = {
		scope:attacker = {
			is_independent_ruler = yes
		}
		scope:target = {
			empire = title:e_calradian_empire
		}
	}

	should_invalidate = {
		NOT = {
			any_in_list = {
				list = target_titles
				any_in_de_jure_hierarchy = {
					tier = tier_county
					holder = {
						target_is_same_character_or_above = scope:defender
					}
				}
			}
		}
	}

	on_invalidated_desc = msg_religious_war_invalidation_region_message

	on_invalidated = {
	}
	
	cost = {
		prestige = {
			add = {
				value = 1000
				desc = CB_BASE_COST
			}
			add = {
				value = 5
				multiply = scope:attacker.realm_size
				desc = CB_REALM_SIZE_COST
				max = 500
			}
			if = {
				limit = {
					scope:attacker = {
						is_ai = yes
					}
				}
				multiply = {
					value = 0.3
					desc = "CB_AI_ATTACKER"
				}
			}
			multiply = common_cb_prestige_cost_multiplier
		}
	}
	on_declaration = {
		on_declared_war = yes
		scope:attacker = {
			add_character_flag = {
				flag = started_imperial_kingdom_expansion
				years = 10
			}
			set_variable = {
				name = started_imperial_kingdom_expansion_variable
				years = 10
			}
		}
	}

	on_victory_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:attacker = { is_local_player = yes } }
				desc = county_conquest_cb_victory_desc_attacker
			}
			desc = county_conquest_cb_victory_desc
		}
	}

	on_victory = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		# Legitimacy
		add_legitimacy_attacker_victory_effect = yes

		# Influence
		add_influence_attacker_victory_effect = yes

		# EP2 accolade glory gain for winning against higher ranked enemy
		scope:attacker = { accolade_attacker_war_end_glory_gain_med_effect = yes }

		create_title_and_vassal_change = {
			type = conquest
			save_scope_as = change
			add_claim_on_loss = yes
		}

		# Go through the dejure hierarchy under target titles, transfer eligible vassals and sieze counties from ineligible ones
		every_in_list = {
			list = target_titles
			custom_tooltip = CONQUEST_CB_TITLE

			expansion_cb_title_transfer = yes
		}

		every_in_list = {
			list = vassals_taken
			change_liege = {
				liege = scope:attacker
				change = scope:change
			}
		}

		every_in_list = {
			list = titles_taken
			change_title_holder = {
				holder = scope:attacker
				change = scope:change
			}
		}
		
		# If applicable, take the target title (i.e. duchy) as well
		every_in_list = {
			list = target_title_taken
			#custom_tooltip = expansion_take_target_title_tt
			change_title_holder = {
				holder = scope:attacker
				change = scope:change
			}
		}

		resolve_title_and_vassal_change = scope:change

		# Prestige Progress for the Attacker
		every_in_list = {
			list = target_titles
			scope:attacker = {
				add_prestige_experience = medium_prestige_value
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker
			FAME_BASE = medium_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		# Truce
		add_truce_attacker_victory_effect = yes

		# FP1: note the victory for future memorialisation via stele (if applicable).
		scope:attacker = { fp1_remember_recent_conquest_victory_effect = yes }

		if = { # Warning that only counties are changing hands
			limit = {
				any_in_list = {
					list = target_titles
					tier = tier_duchy
				}
			}
			random_in_list = {
				list = target_titles
				limit = { tier = tier_duchy }
				save_scope_as = de_jure_target
			}
		}
		if = {
			limit = {
				any_in_list = {
					list = target_titles
					tier = tier_duchy
					holder = scope:defender
				}
			}
			if = {
				limit = {
					scope:defender = {
						any_held_title = {
							tier = tier_county
							NOT = { target_is_de_jure_liege_or_above = scope:de_jure_target }
						}
					}
				}
				custom_tooltip = conquest_title_not_transferred_tt
			}
			else = {
				custom_tooltip = expansion_take_target_title_tt
			}
		}
		else = {
			if = {
				limit = {
					any_in_list = {
						list = target_titles
						tier = tier_duchy
						is_title_created = yes
						holder = {
							NOT = {
								any_sub_realm_county = {
									#tier = tier_county
									NOT = { target_is_de_jure_liege_or_above = scope:de_jure_target }
								}
							}
						}
					}
				}
				custom_tooltip = expansion_take_target_title_tt
			}
			else_if = {
				limit = {
					any_in_list = {
						list = target_titles
						tier = tier_duchy
						is_title_created = yes
					}
				}
				custom_tooltip = conquest_title_usurp_tt
			}
			#else = { custom_tooltip = expansion_create_target_title_tt }
		}
	}

	on_white_peace_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = county_conquest_cb_white_peace_desc_defender
			}
			desc = county_conquest_cb_white_peace_desc
		}
	}

	on_white_peace = {
		scope:attacker = { show_pow_release_message_effect = yes }
		# Prestige loss for the attacker

		# EP2 accolade glory gain for doing pretty good against higher ranked enemy
		scope:defender = { accolade_defender_war_end_glory_gain_low_effect = yes }

		scope:attacker = {
			add_prestige = {
				value = minor_prestige_value
				multiply = -1.0
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker # not impactful as the scale are identical
			FAME_BASE = medium_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}


		add_truce_white_peace_effect = yes
	}

	on_defeat_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = county_conquest_cb_defeat_desc_defender
			}
			triggered_desc = {
				trigger = {
					scope:attacker = {
						is_local_player = yes
						has_targeting_faction = yes
					}
				}
				desc = county_conquest_cb_defeat_desc_attacker
			}
			desc = county_conquest_cb_defeat_desc
		}
	}

	on_defeat = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		# Legitimacy
		add_legitimacy_attacker_defeat_effect = yes

		# Influence
		add_influence_attacker_defeat_effect = yes

		# EP2 accolade glory gain for winning against higher ranked enemy
		scope:defender = { accolade_defender_war_end_glory_gain_med_effect = yes }

		# Prestige loss for the attacker
		scope:attacker = {
			pay_short_term_gold_reparations_effect = {
				GOLD_VALUE = 3
			}
			add_prestige = {
				value = major_prestige_value
				multiply = -1.0
			}
		}

		# Prestige for Defender
		scope:defender = {
			add_prestige_war_defender_effect = {
				PRESTIGE_VALUE = major_prestige_value
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:defender
			FAME_BASE = medium_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		add_truce_attacker_defeat_effect = yes

		scope:attacker = {
			save_temporary_scope_as = loser
		}
		on_lost_aggression_war_discontent_loss = yes
	}

	transfer_behavior = transfer

	on_primary_attacker_death = inherit
	on_primary_defender_death = inherit

	attacker_allies_inherit = yes
	defender_allies_inherit = yes

	war_name = "EXPANSION_WAR_NAME"
	war_name_base = "EXPANSION_WAR_NAME_BASE"
	cb_name = "CK_EXPANSION_KINGDOM_CB_NAME"

	interface_priority = 84

	use_de_jure_wargoal_only = yes

	attacker_wargoal_percentage = 0.8
	
	max_defender_score_from_occupation = 150
	max_attacker_score_from_occupation = 150
}
imperial_territory_cb = {
	icon = duchy_expansion
	group = conquest

	combine_into_one = yes
	should_show_war_goal_subview = yes
	mutually_exclusive_titles = { always = yes }
	ai_only_against_neighbors = yes
	
	attacker_score_from_occupation_scale = 150
	attacker_score_from_battles_scale = 150
	defender_score_from_battles_scale = 150

	allowed_for_character = {
		scope:attacker.culture = {
			has_cultural_pillar = heritage_calradian
		}
		NOT = {
			government_has_flag = government_is_landless_adventurer
		}
	}


	allowed_against_character = {
		scope:attacker = {
			ALL_FALSE = {
				top_liege = scope:defender.top_liege
				liege = scope:defender
			}
		}
		scope:defender.culture = {
			NOT = {
				has_cultural_pillar = heritage_calradian
			}
		}
	}
	target_titles = neighbor_land_or_water
	target_title_tier = duchy
	target_de_jure_regions_above = yes
	ignore_effect = change_title_holder


	ai_score_mult = { ##WIP, add more conditions later
		value = 3 #AI should be eager to reconquer Calradian territories
		if = {
			limit = {
				scope:attacker = {
					has_trait = ambitious
				}
			}
			multiply = 5
		}
		if = {
			limit = {
				scope:attacker = {
					has_trait = ck_militarist
				}
			}
			multiply = 1.5
		}
	}

	valid_to_start = {
		scope:target = {
			empire = title:e_calradian_empire
		}
		#scope:attacker = {
		#	is_independent_ruler = yes
		#}
	}

	should_invalidate = {
		NOT = {
			any_in_list = {
				list = target_titles
				any_in_de_jure_hierarchy = {
					tier = tier_county
					holder = {
						target_is_same_character_or_above = scope:defender
					}
				}
			}
		}
	}

	on_invalidated_desc = msg_religious_war_invalidation_region_message

	on_invalidated = {
	}

	cost = {
		prestige = {
			value = 0
			if = {
				add = {
					value = 10
					multiply = scope:attacker.realm_size
					desc = CB_REALM_SIZE_COST
					max = 200
				}
			}
			if = {
				limit = {
					scope:attacker = {
						is_ai = yes
					}
				}
				multiply = {
					value = 0.3
					desc = "CB_AI_ATTACKER"
				}
			}
			multiply = common_cb_prestige_cost_multiplier
		}
	}

	on_declaration = {
		on_declared_war = yes
	}

	on_victory_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:attacker = { is_local_player = yes } }
				desc = county_conquest_cb_victory_desc_attacker
			}
			desc = county_conquest_cb_victory_desc
		}
	}

	on_victory = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		# Liberator nick
		scope:attacker = {
			if = {
				limit = {
					NOT = {
						has_nickname = nick_the_liberator_ck
					}
				}
				random_list = {
					3 = {
						trigger_event = {
							id = ck_imperial_events.0004
							days = { 1 3 }
						}
					}
					5 = { }
				}
			}
		}
		
		# Legitimacy
		add_legitimacy_attacker_victory_effect = yes

		#EP2 accolade glory gain for winning against higher ranked enemy
		scope:attacker = { accolade_attacker_war_end_glory_gain_med_effect = yes }

		create_title_and_vassal_change = {
			type = conquest
			save_scope_as = change
			add_claim_on_loss = yes
		}

		# EP3 Laamp possibility warning
		scope:defender = { ep3_war_loss_adventurer_tt_effect = yes }

		# go through the dejure hierarchy under target titles, transfer eligible vassals and sieze counties from ineligible ones
		every_in_list = {
			list = target_titles
			custom_tooltip = CONQUEST_CB_TITLE

			conquest_cb_title_transfer = {
				RELIGIOUS_WAR = no
			}
			every_in_de_jure_hierarchy = {
				limit = { holder.top_liege = scope:defender }
				change_title_holder = {
					holder = scope:attacker
					change = scope:change
				}
			}
		}


		every_in_list = {
			list = titles_taken
			change_title_holder = {
				holder = scope:attacker
				change = scope:change
				take_baronies = yes
			}
		}

		resolve_title_and_vassal_change = scope:change

		# Prestige Progress for the Attacker
		every_in_list = {
			list = target_titles
			scope:attacker = {
				add_prestige_experience = medium_prestige_value
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker
			FAME_BASE = medium_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		# Truce
		add_truce_attacker_victory_effect = yes

		# FP1: note the victory for future memorialisation via stele (if applicable).
		scope:attacker = { fp1_remember_recent_conquest_victory_effect = yes }

		if = { # Warning that only counties are changing hands
			limit = {
				any_in_list = {
					list = target_titles
					tier = tier_duchy
				}
			}
			random_in_list = {
				list = target_titles
				limit = { tier = tier_duchy }
				save_scope_as = de_jure_target
			}
		}
		if = {
			limit = {
				any_in_list = {
					list = target_titles
					tier = tier_duchy
					holder = scope:defender
				}
			}
			if = {
				limit = {
					scope:defender = {
						any_held_title = {
							tier = tier_county
							NOT = { target_is_de_jure_liege_or_above = scope:de_jure_target }
						}
					}
				}
				custom_tooltip = conquest_title_not_transferred_tt
			}
			else = { custom_tooltip = conquest_title_destroyed_tt }
		}
		else = {
			if = {
				limit = {
					any_in_list = {
						list = target_titles
						tier = tier_duchy
						is_title_created = yes
					}
				}
				custom_tooltip = conquest_title_usurp_tt
			}
			else = { custom_tooltip = conquest_title_create_tt }
		}
	}

	on_white_peace_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = county_conquest_cb_white_peace_desc_defender
			}
			desc = county_conquest_cb_white_peace_desc
		}
	}

	on_white_peace = {
		scope:attacker = { show_pow_release_message_effect = yes }
		# Prestige loss for the attacker

		#EP2 accolade glory gain for doing pretty good against higher ranked enemy
		scope:defender = { accolade_defender_war_end_glory_gain_low_effect = yes }

		scope:attacker = {
			add_prestige = {
				value = minor_prestige_value
				multiply = -1.0
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker # not impactful as the scale are identical
			FAME_BASE = medium_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}


		add_truce_white_peace_effect = yes
	}

	on_defeat_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = county_conquest_cb_defeat_desc_defender
			}
			triggered_desc = {
				trigger = {
					scope:attacker = {
						is_local_player = yes
						has_targeting_faction = yes
					}
				}
				desc = county_conquest_cb_defeat_desc_attacker
			}
			desc = county_conquest_cb_defeat_desc
		}
	}

	on_defeat = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		# Legitimacy
		add_legitimacy_attacker_defeat_effect = yes

		#EP2 accolade glory gain for winning against higher ranked enemy
		scope:defender = { accolade_defender_war_end_glory_gain_med_effect = yes }

		# Prestige loss for the attacker
		scope:attacker = {
			pay_short_term_gold_reparations_effect = {
				GOLD_VALUE = 3
			}
			add_prestige = {
				value = major_prestige_value
				multiply = -1.0
			}
		}

		# Prestige for Defender
		scope:defender = {
			add_prestige_war_defender_effect = {
				PRESTIGE_VALUE = major_prestige_value
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:defender
			FAME_BASE = medium_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		add_truce_attacker_defeat_effect = yes

		scope:attacker = {
			save_temporary_scope_as = loser
		}
		on_lost_aggression_war_discontent_loss = yes
	}

	transfer_behavior = transfer

	on_primary_attacker_death = inherit
	on_primary_defender_death = inherit

	attacker_allies_inherit = yes
	defender_allies_inherit = yes

	war_name = "CK_RECONQUEST_WAR_NAME"
	war_name_base = "CK_RECONQUEST_WAR_NAME_BASE"
	cb_name = "CK_RECONQUEST_CB_NAME"

	interface_priority = 79

	use_de_jure_wargoal_only = yes

	attacker_wargoal_percentage = 0.8
	
	max_defender_score_from_occupation = 150
	max_attacker_score_from_occupation = 150
}
imperial_authority_cb = {
	icon = vassalization
	group = vassalization
	ai_only_against_neighbors = yes
	
	attacker_score_from_occupation_scale = 150
	attacker_score_from_battles_scale = 200
	defender_score_from_battles_scale = 300
	
	allowed_for_character = {
		scope:attacker = {
			culture = {
				has_cultural_pillar = heritage_calradian
			}
			OR = {
				has_trait = claimant_emperor
				has_title = title:e_calradian_empire
			}
		}
		NOT = {
			government_has_flag = government_is_landless_adventurer
		}
	}

	# Root is the title
	# scope:attacker is the attacker
	# scope:defender is the defender

	
	allowed_against_character = {
		scope:defender = {
			is_independent_ruler = yes
			culture = {
				has_cultural_pillar = heritage_calradian
			}
		}
		scope:defender.primary_title = {
			empire = title:e_calradian_empire
			#is_neighbor_to_realm = scope:attacker
		}
		scope:defender = {
			character_is_land_realm_neighbor = scope:attacker
		}
		
		scope:attacker.primary_title.tier > scope:defender.primary_title.tier # Must be lower tier
		
	}
	
	cost = {
		prestige = {
			value = 0
			add = {
				desc = CB_SIZE_OF_TARGET_REALM_COST
				scope:defender = {
					every_sub_realm_county = {
						add = {
							value = 50
						}
					}
				}
			}
			if = {
				limit = {
					scope:attacker = {
						is_ai = yes
					}
				}
				multiply = {
					value = 0.3
					desc = "CB_AI_ATTACKER"
				}
			}
			if = {
				limit = {
					scope:defender.primary_title = {
						tier = tier_kingdom
					}
				}
				multiply = {
					value = 1.5
					desc = CB_VASSALIZING_KING
				}
			}

			multiply = common_cb_prestige_cost_multiplier
		}
	}
	
	should_invalidate = {
		OR = {
			scope:defender = {
				is_independent_ruler = no
			}
			scope:defender.primary_title.tier >= scope:attacker.primary_title.tier
		}
	}
	
	on_declaration = {
		on_declared_war = yes
	}	
	
	on_invalidated_desc = msg_vassalization_war_invalidated_message
	
	on_invalidated = {}

	on_victory_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:attacker = { is_local_player = yes } }
				desc = vassalization_cb_victory_desc_attacker
			}
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = vassalization_cb_victory_desc_defender
			}
			desc = vassalization_cb_victory_desc
		}
	}
	
	on_victory = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		create_title_and_vassal_change = {
			type = swear_fealty
			save_scope_as = change
			add_claim_on_loss = no
		}
		scope:defender = {
			change_liege = {
				liege = scope:attacker
				change = scope:change
			}
			resolve_title_and_vassal_change = scope:change
		}
		
		
		# Prestige level progress for the attacker
		scope:attacker = {
			add_prestige_experience = {
				value = medium_prestige_value
			}
		}

		# Prestige loss for the defender
		scope:defender = {
			add_prestige = {
				value = medium_prestige_value
				multiply = -1.0
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker
			FAME_BASE = major_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}
		
		# Truce
		add_truce_attacker_victory_effect = yes
	}

	on_white_peace_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = vassalization_cb_white_peace_desc_defender
			}
			desc = vassalization_cb_white_peace_desc
		}
	}
	
	on_white_peace = {
		scope:attacker = { show_pow_release_message_effect = yes }

		#EP2 accolade glory gain for doing ok against higher ranked enemy
		scope:defender = { accolade_defender_war_end_glory_gain_low_effect = yes }

		# Prestige loss for the attacker
		scope:attacker = {
			add_prestige = {
				value = minor_prestige_value
				multiply = -1.0
			}
			stress_impact = {
				ambitious = medium_stress_impact_gain
				arrogant = medium_stress_impact_gain
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker # Not important as the scales are identical
			FAME_BASE = minor_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}
		
		scope:defender = {
			stress_impact = {
				arrogant = medium_stress_impact_gain
			}
		}

		# Truce
		add_truce_white_peace_effect = yes
	}

	on_defeat_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = vassalization_cb_white_peace_desc_defender
			}
			triggered_desc = {
				trigger = {
					scope:attacker = {
						is_local_player = yes
						has_targeting_faction = yes
					}
				}
				desc = vassalization_cb_defeat_desc_attacker
			}
			desc = vassalization_cb_white_peace_desc
		}
	}
	
	on_defeat = {
		scope:attacker = { show_pow_release_message_effect = yes }

		#EP2 accolade glory gain for winning against higher ranked enemy
		scope:defender = { accolade_defender_war_end_glory_gain_med_effect = yes }
		
		# Prestige loss for the attacker
		scope:attacker = {
			pay_short_term_gold_reparations_effect = {
				GOLD_VALUE = 3
			}
			add_prestige = {
				value = major_prestige_value
				multiply = -1.0
			}
		}

		# Prestige for the defender
		scope:defender = {
			add_prestige_war_defender_effect = {
				PRESTIGE_VALUE = medium_prestige_value
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:defender
			FAME_BASE = major_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}
		
		scope:attacker = {
			save_temporary_scope_as = loser
		}

		# Truce
		add_truce_attacker_defeat_effect = yes
		
		on_lost_aggression_war_discontent_loss = yes
	}
	
	on_primary_attacker_death = inherit
	on_primary_defender_death = inherit
	
	attacker_allies_inherit = yes
	defender_allies_inherit = yes
	
	war_name = "CK_IMPOSE_AUTHORITY_WAR_NAME"
	war_name_base = "CK_IMPOSE_AUTHORITY_WAR_NAME_BASE"
	cb_name = "CK_IMPOSE_AUTHORITY_CB_NAME"
	interface_priority = 59
	
	ticking_war_score_targets_entire_realm = yes
	max_defender_score_from_occupation = 150
	max_attacker_score_from_occupation = 150
	max_attacker_score_from_battles = 100
	max_defender_score_from_battles = 100
	attacker_ticking_warscore = 0
	attacker_wargoal_percentage = 0.8
	
	max_ai_diplo_distance_to_title = 500

	ai_score_mult = { ## WIP, add more conditions later ##
		value = 1.5 # Emperors should be eager to vassalize independent calradians
		if = {
			limit = {
				scope:attacker = {
					has_trait = ambitious
				}
			}
			multiply = 5
		}
		if = {
			limit = {
				scope:attacker = {
					has_trait = ck_militarist
				}
			}
			multiply = 1.5
		}
		
	}
}
foreign_county_expansion_cb = {
	icon = county_expansion
	group = conquest

	combine_into_one = yes
	should_show_war_goal_subview = yes
	mutually_exclusive_titles = { always = yes }

	allowed_for_character = {
		scope:attacker.culture = {
			has_cultural_pillar = heritage_calradian
		}
		NOT = {
			government_allows = administrative
		}
		NOT = {
			government_has_flag = government_is_landless_adventurer
		}
	}

	allowed_against_character = {
		scope:attacker = {
			ALL_FALSE = {
				top_liege = scope:defender.top_liege
				liege = scope:defender
			}
		}
		scope:defender = {
			NOT = {
				culture = {
					has_cultural_pillar = heritage_calradian
				}
			}
		}
	}
	target_titles = neighbor_land_or_water
	target_title_tier = county
	ignore_effect = change_title_holder
	
	attacker_score_from_occupation_scale = 150
	attacker_score_from_battles_scale = 150
	defender_score_from_battles_scale = 150

	ai_only_against_neighbors = yes
	
	ai_score_mult = {
		value = 1
		if = { ### So Calradians won't swallow Geroia immediately
			limit = {
				current_date <= 1100.1.1
				scope:attacker = {
					is_independent_ruler = no
					NOT = {
						capital_province = {
							geographical_region = region_geroia
						}
					}
				}
				scope:defender = {
					OR = {
						culture = { has_cultural_pillar = heritage_geroian }
						culture = { has_cultural_pillar = heritage_lotkian }
					}
				}
			}
			multiply = 0
		}
		if = { ### So Calradians take into account coalition possibility
			limit = {
				scope:attacker = {
					has_game_rule = ck_geroian_coalition_enabled
					is_independent_ruler = no
					NOT = {
						capital_province = {
							geographical_region = region_geroia
						}
					}
				}
				scope:defender = {
					culture = { has_cultural_pillar = heritage_geroian }
				}
			}
			multiply = 0.3
		}
	}

	valid_to_start = {
		scope:attacker = {
			highest_held_title_tier <= tier_kingdom
		}
		scope:target = {
			NOT = {
				empire = title:e_calradian_empire
			}
		}
	}

	allowed_for_character_display_regardless = {
	}

	should_invalidate = {
		NOT = {
			any_in_list = {
				list = target_titles
				any_in_de_jure_hierarchy = {
					tier = tier_county
					holder = {
						OR = {
							this = scope:defender
							target_is_liege_or_above = scope:defender
						}
					}
				}
			}
		}
	}

	on_invalidated_desc = msg_county_conquest_war_invalidated_message
	on_invalidated = {}

	cost = {
		prestige = {
			add = {
				value = 50
				desc = CB_BASE_COST
			}
			add = {
				value = 2.5
				multiply = scope:attacker.realm_size
				desc = CB_REALM_SIZE_COST
				max = 150
			}
			if = {
				limit = {
					scope:attacker = {
						is_ai = yes
					}
				}
				multiply = {
					value = 0.3
					desc = "CB_AI_ATTACKER"
				}
			}
			multiply = common_cb_prestige_cost_multiplier
		}
	}

	on_declaration = {
		on_declared_war = yes
	}

	on_victory_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:attacker = { is_local_player = yes } }
				desc = county_conquest_cb_victory_desc_attacker
			}
			desc = county_conquest_cb_victory_desc
		}
	}

	on_victory = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		# Legitimacy
		add_legitimacy_attacker_victory_effect = yes

		# Influence
		add_influence_attacker_victory_effect = yes

		# EP2 accolade glory gain for winning against higher ranked enemy
		scope:attacker = { accolade_attacker_war_end_glory_gain_low_effect = yes }

		create_title_and_vassal_change = {
			type = conquest
			save_scope_as = change
			add_claim_on_loss = yes
		}

		# Grab the designated county.
		every_in_list = {
			list = target_titles
			change_title_holder = {
				holder = scope:attacker
				change = scope:change
			}
		}

		resolve_title_and_vassal_change = scope:change

		# Prestige Progress for the Attacker
		every_in_list = {
			list = target_titles
			scope:attacker = {
				add_prestige_experience = minor_prestige_value
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker
			FAME_BASE = minor_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		# Truce
		add_truce_attacker_victory_effect = yes

		# FP1: note the victory for future memorialisation via stele (if applicable).
		scope:attacker = { fp1_remember_recent_conquest_victory_effect = yes }
	}

	on_white_peace_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = county_conquest_cb_white_peace_desc_defender
			}
			desc = county_conquest_cb_white_peace_desc
		}
	}

	on_white_peace = {
		scope:attacker = { show_pow_release_message_effect = yes }
		# Prestige loss for the attacker
		scope:attacker = {
			add_prestige = {
				value = minor_prestige_value
				multiply = -1.0
			}
			stress_impact = {
 				ambitious = medium_stress_impact_gain
 				arrogant = medium_stress_impact_gain
 			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker # Not important as the scales are identical
			FAME_BASE = minor_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		scope:defender = {
			stress_impact = {
 				arrogant = medium_stress_impact_gain
 			}
		}

		add_truce_white_peace_effect = yes
	}

	on_defeat_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = county_conquest_cb_defeat_desc_defender
			}
			triggered_desc = {
				trigger = {
					scope:attacker = {
						is_local_player = yes
						has_targeting_faction = yes
					}
				}
				desc = county_conquest_cb_defeat_desc_attacker
			}
			desc = county_conquest_cb_defeat_desc
		}
	}

	on_defeat = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		# Legitimacy
		add_legitimacy_attacker_defeat_effect = yes

		# Influence
		add_influence_attacker_defeat_effect = yes

		# EP2 accolade glory gain for winning against higher ranked enemy
		scope:defender = { accolade_defender_war_end_glory_gain_low_effect = yes }

		# Prestige loss for the attacker
		scope:attacker = {
			pay_short_term_gold_reparations_effect = {
				GOLD_VALUE = 2
			}
			add_prestige = medium_prestige_loss
		}

		# Prestige for Defender
		scope:defender = {
			add_prestige_war_defender_effect = {
				PRESTIGE_VALUE = medium_prestige_value
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:defender
			FAME_BASE = minor_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		add_truce_attacker_defeat_effect = yes

		scope:attacker = {
			save_temporary_scope_as = loser
		}
		on_lost_aggression_war_discontent_loss = yes
	}

	transfer_behavior = transfer

	on_primary_attacker_death = inherit
	on_primary_defender_death = inherit

	attacker_allies_inherit = yes
	defender_allies_inherit = yes

	war_name = "EXPANSION_WAR_NAME"
	war_name_base = "EXPANSION_WAR_NAME_BASE"
	cb_name = "CK_FOREIGN_EXPANSION_COUNTY_CB_NAME"

	interface_priority = 83

	use_de_jure_wargoal_only = yes

	attacker_wargoal_percentage = 0.8
	
	max_defender_score_from_occupation = 150
	max_attacker_score_from_occupation = 150
}
imperial_expedition_cb = {
	icon = invasion
	group = conquest

	combine_into_one = yes
	should_show_war_goal_subview = yes
	mutually_exclusive_titles = { always = yes }
	
	attacker_score_from_occupation_scale = 150
	attacker_score_from_battles_scale = 150
	defender_score_from_battles_scale = 150

	allowed_for_character = {
		OR = {
			AND = {
				is_ai = yes
				highest_held_title_tier = tier_empire
				capital_county = {
					empire = title:e_calradian_empire
				}
				OR = {
					AND = {
						has_trait = ck_oligarch
						sub_realm_size >= 35
					}
					AND = {
						OR = {
							has_trait = ck_populist
							has_trait = ck_royalist
						}
						sub_realm_size >= 30
					}
					AND = {
						has_trait = ck_militarist
						sub_realm_size >= 25
					}
				}
				NOT = {
					has_character_flag = ai_expedition_cooldown
				}
			}
			AND = {
				is_ai = no
				has_character_flag = has_expedition_cb
			}
		}
		scope:attacker.culture = {
			has_cultural_pillar = heritage_calradian
		}
		NOT = {
			government_has_flag = government_is_landless_adventurer
		}
	}

	allowed_against_character = {
		scope:attacker = {
			ALL_FALSE = {
				top_liege = scope:defender.top_liege
				liege = scope:defender
			}
		}
	}

	target_titles = neighbor_land_or_water
	target_title_tier = duchy
	target_de_jure_regions_above = yes
	ignore_effect = change_title_holder

	ai_only_against_neighbors = yes
	
	ai_score_mult = {
		value = 1.5
		if = {
			limit = {
				scope:attacker = {
					has_trait = ambitious
				}
			}
			multiply = 1.5
		}
		if = {
			limit = {
				scope:attacker = {
					has_trait = ck_militarist
				}
			}
			multiply = 1.5
		}
	}

	valid_to_start = {
		scope:attacker = {
			is_independent_ruler = yes
		}
		scope:target = {
			NOT = {
				empire = title:e_calradian_empire
			}
		}
	}

	should_invalidate = {
		NOT = {
			any_in_list = {
				list = target_titles
				any_in_de_jure_hierarchy = {
					tier = tier_county
					holder = {
						target_is_same_character_or_above = scope:defender
					}
				}
			}
		}
	}

	on_invalidated_desc = msg_religious_war_invalidation_region_message

	on_invalidated = {
	}
	
	cost = {
		gold = {
			add = {
				value = 0
				desc = CB_BASE_COST
			}
			if = {
				limit = {
					scope:attacker = {
						is_ai = yes
					}
				}
				add = {
					value = 200
					desc = CB_AI_GOLD_COST
				}
			}
		}
	}

	on_declaration = {
		on_declared_war = yes
		scope:attacker = {
			every_vassal_or_below = {
				if = {
					limit = {
						is_ai = no
					}
					trigger_event = ck_imperial_events.0011
				}
			}
			if = {
				limit = {
					is_ai = no
				}
				trigger_event = ck_imperial_events.0010
			}
			if = {
				limit = {
					is_ai = yes
				}
				add_character_flag = {
					flag = ai_expedition_cooldown
					years = 5
				}
			}
		}
	}

	on_victory_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:attacker = { is_local_player = yes } }
				desc = county_conquest_cb_victory_desc_attacker
			}
			desc = county_conquest_cb_victory_desc
		}
	}

	on_victory = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		# Legitimacy
		add_legitimacy_attacker_victory_effect = yes

		# Influence
		add_influence_attacker_victory_effect = yes

		# EP2 accolade glory gain for winning against higher ranked enemy
		scope:attacker = { accolade_attacker_war_end_glory_gain_med_effect = yes }

		create_title_and_vassal_change = {
			type = conquest
			save_scope_as = change
			add_claim_on_loss = yes
		}

		every_in_list = {
			list = target_titles
			custom_tooltip = CONQUEST_CB_TITLE

			conquest_cb_title_transfer = {
				RELIGIOUS_WAR = no
			}
			every_in_de_jure_hierarchy = {
				limit = { holder.top_liege = scope:defender }
				change_title_holder = {
					holder = scope:attacker
					change = scope:change
				}
			}
		}


		every_in_list = {
			list = titles_taken
			change_title_holder = {
				holder = scope:attacker
				change = scope:change
				take_baronies = yes
			}
		}

		resolve_title_and_vassal_change = scope:change

		# Prestige Progress for the Attacker
		every_in_list = {
			list = target_titles
			scope:attacker = {
				add_prestige_experience = medium_prestige_value
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker
			FAME_BASE = medium_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}
		
		scope:attacker = {
			save_scope_as = emperor_success
			trigger_event = ck_imperial_events.0014
			
			every_vassal_or_below = {
				if = {
					limit = {
						has_character_flag = was_promised_title_expedition
					}
					trigger_event = {
						id = ck_imperial_events.0027
						months = 6
					}
				}
			}
		}
		every_ruler = {
			limit = {
				NOT = {
					this = scope:attacker
				}
				OR = {
					is_vassal_or_below_of = scope:attacker
					culture = {
						has_cultural_pillar = heritage_calradian
					}
				}
			}
			trigger_event = ck_imperial_events.0014
		}
		#Expedition Colonization
		if = {
			limit = {
				scope:attacker = {
					has_character_flag = agreed_to_expedition_colonization
				}
			}
			random_in_list = {
				list = target_titles
				random_in_de_jure_hierarchy = {
					limit = {
						tier = tier_county
					}
					save_scope_as = county_expedition
				}
			}
			scope:attacker = {
				send_interface_message = {
					type = send_interface_message_good
					title = expedition_county_colonized_title
					custom_tooltip = expedition_county_colonized_desc
					right_icon = scope:county_expedition
				}
			}
			scope:county_expedition = {
				if = {
					limit = { ### Geroian - Nisotisean
						culture = {
							has_cultural_pillar = heritage_geroian
						}
					}
				
					set_county_culture = culture:calradian_geroian
					culture:calradian_geroian = {
						get_all_innovations_from = scope:attacker.culture
					}
				}
				else_if = {
					limit = { ### Lotkian - Dysnisean
						culture = {
							has_cultural_pillar = heritage_lotkian
						}
					}
					set_county_culture = culture:calradian_lotkian
					culture:calradian_lotkian = {
						get_all_innovations_from = scope:attacker.culture
					}
				}
				else_if = {
					limit = { ### Gottic - Gotisean
			
						culture = {
							has_cultural_pillar = heritage_gottic
						}
					}
					
					set_county_culture = culture:calradian_gottic
					culture:calradian_gottic = {
						get_all_innovations_from = scope:attacker.culture
					}
				}
				else_if = {
					limit = { ### Central Balionic - Valandean
			
						culture = {
							has_cultural_pillar = heritage_balian
						}
					}
					
					set_county_culture = culture:calradian_balionic
					culture:calradian_balionic = {
						get_all_innovations_from = scope:attacker.culture
					}
				}
				else_if = {
					limit = { ### Western Aserai - Kannean
			
						culture = {
							has_cultural_pillar = heritage_nahasi
						}
						title_province = {
							geographical_region = region_west_nahasa
						}
					}
					
					set_county_culture = culture:calradian_western_aserai
					culture:calradian_western_aserai = {
						get_all_innovations_from = scope:attacker.culture
					}
				}
				else_if = {
					limit = { ### Eastern Aserai - Aseroulean
			
						culture = {
							has_cultural_pillar = heritage_nahasi
						}
						title_province = {
							geographical_region = region_east_nahasa
						}
					}
					
					set_county_culture = culture:calradian_eastern_aserai
					culture:calradian_eastern_aserai = {
						get_all_innovations_from = scope:attacker.culture
					}
				}
				else_if = {
					limit = { ### Safanit - Palothoi
			
						culture = {
							has_cultural_pillar = heritage_safanit
						}
					}
					
					set_county_culture = culture:calradian_safanit
					culture:calradian_safanit = {
						get_all_innovations_from = scope:attacker.culture
					}
				}
				else_if = {
					limit = { ### Khuzic - Voretisean
			
						culture = {
							has_cultural_pillar = heritage_khuzic
						}
					}
					
					set_county_culture = culture:calradian_khuzic
					culture:calradian_khuzic = {
						get_all_innovations_from = scope:attacker.culture
					}
				}
				else_if = {
					limit = { ### Kohinik - Penthian
			
						culture = {
							has_cultural_pillar = heritage_kohinik
						}
					}
					
					set_county_culture = culture:calradian_kohinik
					culture:calradian_kohinik = {
						get_all_innovations_from = scope:attacker.culture
					}
				}
				else_if = {
					limit = { ### Darshi - Darnicean
			
						culture = {
							has_cultural_pillar = heritage_darshi
						}
					}
					
					set_county_culture = culture:calradian_darshi
					culture:calradian_darshi = {
						get_all_innovations_from = scope:attacker.culture
					}
				}
				else_if = {
					limit = { ### Lir Ovuz - Lirvasean
			
						culture = {
							has_cultural_pillar = heritage_lir_ovus
						}
					}
					
					set_county_culture = culture:calradian_lirovuz
					culture:calradian_lirovuz = {
						get_all_innovations_from = scope:attacker.culture
					}
				}
				else_if = {
					limit = { ### Sturgic - Stourgi
			
						culture = {
							has_cultural_pillar = heritage_sturgic
						}
					}
					
					set_county_culture = culture:calradian_sturgic
					culture:calradian_sturgic = {
						get_all_innovations_from = scope:attacker.culture
					}
				}
				else_if = {
					limit = { ### Chertygic - Vannae
			
						culture = {
							has_cultural_pillar = heritage_chertygic
						}
					}
					
					set_county_culture = culture:calradian_chertygic
					culture:calradian_chertygic = {
						get_all_innovations_from = scope:attacker.culture
					}
				}
				else_if = {
					limit = { ### Byalic - Boreali
			
						culture = {
							has_cultural_pillar = heritage_byalic
						}
					}
					
					set_county_culture = culture:calradian_byalic
					culture:calradian_byalic = {
						get_all_innovations_from = scope:attacker.culture
					}
				}
				else_if = {
					limit = { ### Battanian - Antywalean
			
						culture = {
							has_cultural_pillar = heritage_battanian
						}
					}
					
					set_county_culture = culture:calradian_battanian
					culture:calradian_battanian = {
						get_all_innovations_from = scope:attacker.culture
					}
				}
			}
			scope:attacker = {
				remove_character_flag = agreed_to_expedition_colonization
			}
		}
		
		# Truce
		add_truce_attacker_victory_effect = yes

		# FP1: note the victory for future memorialisation via stele (if applicable).
		scope:attacker = { fp1_remember_recent_conquest_victory_effect = yes }

		if = { # Warning that only counties are changing hands
			limit = {
				any_in_list = {
					list = target_titles
					tier = tier_duchy
				}
			}
			random_in_list = {
				list = target_titles
				limit = { tier = tier_duchy }
				save_scope_as = de_jure_target
			}
		}
		if = {
			limit = {
				any_in_list = {
					list = target_titles
					tier = tier_duchy
					holder = scope:defender
				}
			}
			if = {
				limit = {
					scope:defender = {
						any_held_title = {
							tier = tier_county
							NOT = { target_is_de_jure_liege_or_above = scope:de_jure_target }
						}
					}
				}
				custom_tooltip = conquest_title_not_transferred_tt
			}
			else = {
				custom_tooltip = expansion_take_target_title_tt
			}
		}
		else = {
			if = {
				limit = {
					any_in_list = {
						list = target_titles
						tier = tier_duchy
						is_title_created = yes
						holder = {
							NOT = {
								any_sub_realm_county = {
									#tier = tier_county
									NOT = { target_is_de_jure_liege_or_above = scope:de_jure_target }
								}
							}
						}
					}
				}
				custom_tooltip = expansion_take_target_title_tt
			}
			else_if = {
				limit = {
					any_in_list = {
						list = target_titles
						tier = tier_duchy
						is_title_created = yes
					}
				}
				custom_tooltip = conquest_title_usurp_tt
			}
			#else = { custom_tooltip = expansion_create_target_title_tt }
		}
	}

	on_white_peace_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = county_conquest_cb_white_peace_desc_defender
			}
			desc = county_conquest_cb_white_peace_desc
		}
	}

	on_white_peace = {
		scope:attacker = { show_pow_release_message_effect = yes }
		# Prestige loss for the attacker

		# EP2 accolade glory gain for doing pretty good against higher ranked enemy
		scope:defender = { accolade_defender_war_end_glory_gain_low_effect = yes }

		scope:attacker = {
			add_prestige = {
				value = minor_prestige_value
				multiply = -1.0
			}
		}
		
		scope:attacker = {
			save_scope_as = emperor_failure
			trigger_event = ck_imperial_events.0013
		}
		every_ruler = {
			limit = {
				NOT = {
					this = scope:attacker
				}
				OR = {
					is_vassal_or_below_of = scope:attacker
					culture = {
						has_cultural_pillar = heritage_calradian
					}
				}
			}
			trigger_event = ck_imperial_events.0013
		}
		
		#Expedition colonization
		if = {
			limit = {
				scope:attacker = {
					has_character_flag = agreed_to_expedition_colonization
				}
			}
			scope:attacker = {
				remove_character_flag = agreed_to_expedition_colonization
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker # not impactful as the scale are identical
			FAME_BASE = medium_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}


		add_truce_white_peace_effect = yes
	}

	on_defeat_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = county_conquest_cb_defeat_desc_defender
			}
			triggered_desc = {
				trigger = {
					scope:attacker = {
						is_local_player = yes
						has_targeting_faction = yes
					}
				}
				desc = county_conquest_cb_defeat_desc_attacker
			}
			desc = county_conquest_cb_defeat_desc
		}
	}

	on_defeat = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		# Legitimacy
		add_legitimacy_attacker_defeat_effect = yes

		# Influence
		add_influence_attacker_defeat_effect = yes

		# EP2 accolade glory gain for winning against higher ranked enemy
		scope:defender = { accolade_defender_war_end_glory_gain_med_effect = yes }

		# Prestige loss for the attacker
		scope:attacker = {
			pay_short_term_gold_reparations_effect = {
				GOLD_VALUE = 3
			}
			add_prestige = {
				value = major_prestige_value
				multiply = -1.0
			}
		}

		scope:attacker = {
			save_scope_as = emperor_failure
			trigger_event = ck_imperial_events.0013
		}
		every_ruler = {
			limit = {
				NOT = {
					this = scope:attacker
				}
				OR = {
					is_vassal_or_below_of = scope:attacker
					culture = {
						has_cultural_pillar = heritage_calradian
					}
				}
			}
			trigger_event = ck_imperial_events.0013
		}

		#Expedition colonization
		if = {
			limit = {
				scope:attacker = {
					has_character_flag = agreed_to_expedition_colonization
				}
			}
			scope:attacker = {
				remove_character_flag = agreed_to_expedition_colonization
			}
		}

		# Prestige for Defender
		scope:defender = {
			add_prestige_war_defender_effect = {
				PRESTIGE_VALUE = major_prestige_value
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:defender
			FAME_BASE = medium_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		add_truce_attacker_defeat_effect = yes

		scope:attacker = {
			save_temporary_scope_as = loser
		}
		on_lost_aggression_war_discontent_loss = yes
	}

	transfer_behavior = transfer

	on_primary_attacker_death = inherit
	on_primary_defender_death = inherit

	attacker_allies_inherit = yes
	defender_allies_inherit = yes

	war_name = "CK_IMPERIAL_EXPEDITION_WAR_NAME"
	war_name_base = "CK_IMPERIAL_EXPEDITION_WAR_NAME_BASE"
	cb_name = "CK_IMPERIAL_EXPEDITION_CB_NAME"

	interface_priority = 84

	use_de_jure_wargoal_only = yes

	attacker_wargoal_percentage = 0.8
	
	max_defender_score_from_occupation = 150
	max_attacker_score_from_occupation = 150
}
ck_depose_false_emperor = { ### Available for the Calradian Emperor - Dissolution war against other claimants
	icon = vassalization
	group = vassalization
	ai_only_against_neighbors = no
	combine_into_one = yes
	
	attacker_score_from_occupation_scale = 250
	attacker_score_from_battles_scale = 500
	defender_score_from_battles_scale = 300
	
	allowed_for_character = {
		scope:attacker = {
			any_held_title = {
				this = title:e_calradian_empire
			}
		}
	}

	# Root is the title
	# scope:attacker is the attacker
	# scope:defender is the defender

	
	allowed_against_character = {
		scope:defender = {
			is_independent_ruler = yes
			has_trait = claimant_emperor
			any_held_title = {
				tier = tier_empire
			}
		}
		
	}
	
	cost = {}	
	
	should_invalidate = {
		scope:defender.primary_title = {
			tier < tier_empire
		}
	}
	
	on_declaration = {
		on_declared_war = yes
	}	
	
	on_invalidated_desc = msg_depose_invalidated
	
	on_invalidated = {}

	on_victory_desc = {
		desc = depose_cb_victory_desc
	}
	
	on_victory = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		scope:attacker = { trigger_event = ck_imperial_events.0024 }
		
		custom_tooltip = deposed_imprisoned_tt
		custom_tooltip = empire_destroyed_cb_tt
		custom_tooltip = get_their_lands_tt
		create_title_and_vassal_change = {
			type = conquest
			save_scope_as = change
			add_claim_on_loss = yes
		}
		scope:defender = {
			every_held_title = {
				limit = {
					NOT = {
						tier = tier_empire
					}
				}
				change_title_holder = {
					holder = scope:attacker
					change = scope:change
					take_baronies = no
				}
			}
		}
		resolve_title_and_vassal_change = scope:change
		
		hidden_effect = {
			scope:attacker = {
				add_courtier = scope:defender
			}
			scope:defender = {
				hard_imprison_character_effect = {
					TARGET = this
					IMPRISONER = scope:attacker
				}
				every_held_title = {
					limit = {
						tier >= tier_duchy
					}
					holder = {
						destroy_title = prev
					}
				}
			}
		}
		
		# Prestige level progress for the attacker
		scope:attacker = {
			add_prestige_experience = {
				value = medium_prestige_value
			}
		}

		# Prestige loss for the defender
		scope:defender = {
			add_prestige = {
				value = medium_prestige_value
				multiply = -1.0
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker
			FAME_BASE = major_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}
		
		# Truce
		add_truce_attacker_victory_effect = yes
	}

	on_white_peace_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = vassalization_cb_white_peace_desc_defender
			}
			desc = vassalization_cb_white_peace_desc
		}
	}
	
	on_white_peace = {
		scope:attacker = { show_pow_release_message_effect = yes }

		#EP2 accolade glory gain for doing ok against higher ranked enemy
		scope:defender = { accolade_defender_war_end_glory_gain_low_effect = yes }

		# Prestige loss for the attacker
		scope:attacker = {
			add_prestige = {
				value = minor_prestige_value
				multiply = -1.0
			}
			stress_impact = {
				ambitious = medium_stress_impact_gain
				arrogant = medium_stress_impact_gain
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker # Not important as the scales are identical
			FAME_BASE = minor_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}
		
		scope:defender = {
			stress_impact = {
				arrogant = medium_stress_impact_gain
			}
		}

		# Truce
		add_truce_white_peace_effect = yes
	}

	on_defeat_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = vassalization_cb_white_peace_desc_defender
			}
			triggered_desc = {
				trigger = {
					scope:attacker = {
						is_local_player = yes
						has_targeting_faction = yes
					}
				}
				desc = vassalization_cb_defeat_desc_attacker
			}
			desc = vassalization_cb_white_peace_desc
		}
	}
	
	on_defeat = {
		scope:attacker = { show_pow_release_message_effect = yes }

		#EP2 accolade glory gain for winning against higher ranked enemy
		scope:defender = { accolade_defender_war_end_glory_gain_med_effect = yes }
		
		# Prestige loss for the attacker
		scope:attacker = {
			pay_short_term_gold_reparations_effect = {
				GOLD_VALUE = 3
			}
			add_prestige = {
				value = major_prestige_value
				multiply = -1.0
			}
		}

		# Prestige for the defender
		scope:defender = {
			add_prestige_war_defender_effect = {
				PRESTIGE_VALUE = medium_prestige_value
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:defender
			FAME_BASE = major_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}
		
		scope:attacker = {
			save_temporary_scope_as = loser
		}

		# Truce
		add_truce_attacker_defeat_effect = yes
		
		on_lost_aggression_war_discontent_loss = yes
	}
	

	
	ticking_war_score_targets_entire_realm = yes
	max_defender_score_from_occupation = 150
	max_attacker_score_from_occupation = 150
	max_attacker_score_from_battles = 150
	max_defender_score_from_battles = 150
	attacker_ticking_warscore = 0
	attacker_wargoal_percentage = 0.8
	
	max_ai_diplo_distance_to_title = 500

	ai_score_mult = { #Get rid of other emperors asap
		value = 1000
	}
	
	transfer_behavior = transfer

	on_primary_attacker_death = inherit
	on_primary_defender_death = inherit

	attacker_allies_inherit = yes
	defender_allies_inherit = yes

	war_name = "CK_DEPOSE_FALSE_EMPEROR_WAR_NAME"
	war_name_base = "CK_DEPOSE_FALSE_EMPEROR_WAR_NAME_BASE"
	cb_name = "CK_DEPOSE_FALSE_EMPEROR_CB_NAME"

	interface_priority = 84

	use_de_jure_wargoal_only = yes

	attacker_wargoal_percentage = 0.8
	
}
#####
# Geroian & Lotkian CBs
#####
geroian_consolidation_cb = {
	icon = claim_cb ### PLACEHOLDER ### I gave it default icon for now, if you guys have better idea, go ahead and change it
	group = conquest

	combine_into_one = yes
	should_show_war_goal_subview = yes
	mutually_exclusive_titles = { always = yes }

	allowed_for_character = {
		scope:attacker.culture = {
			has_cultural_pillar = heritage_geroian
		}
		NOT = {
			government_has_flag = government_is_landless_adventurer
		}
	}

	allowed_against_character = {
		scope:attacker = {
			ALL_FALSE = {
				top_liege = scope:defender.top_liege
				liege = scope:defender
			}
		}
	}
	target_titles = neighbor_land
	target_title_tier = county
	ignore_effect = change_title_holder
	
	attacker_score_from_occupation_scale = 150
	attacker_score_from_battles_scale = 150
	defender_score_from_battles_scale = 150

	ai_only_against_neighbors = yes
	
	ai_score_mult = {
		value = 1
	}

	valid_to_start = {
		scope:attacker = {
			is_independent_ruler = yes
		}
		scope:target.title_province = {
			geographical_region = region_geroia
		}
	}

	allowed_for_character_display_regardless = {
	}

	should_invalidate = {
		NOT = {
			any_in_list = {
				list = target_titles
				any_in_de_jure_hierarchy = {
					tier = tier_county
					holder = {
						OR = {
							this = scope:defender
							target_is_liege_or_above = scope:defender
						}
					}
				}
			}
		}
	}

	on_invalidated_desc = msg_county_conquest_war_invalidated_message
	on_invalidated = {}

	cost = {
		prestige = {
			add = {
				value = 80
				desc = CB_BASE_COST
			}
			add = {
				value = 2.5
				multiply = scope:attacker.realm_size
				desc = CB_REALM_SIZE_COST
				max = 150
			}
			if = {
				limit = {
					scope:attacker = {
						is_ai = yes
					}
				}
				multiply = {
					value = 0.3
					desc = "CB_AI_ATTACKER"
				}
			}
			multiply = common_cb_prestige_cost_multiplier
		}
	}

	on_declaration = {
		on_declared_war = yes
	}

	on_victory_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:attacker = { is_local_player = yes } }
				desc = county_conquest_cb_victory_desc_attacker
			}
			desc = county_conquest_cb_victory_desc
		}
	}

	on_victory = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		# Legitimacy
		add_legitimacy_attacker_victory_effect = yes

		# Influence
		add_influence_attacker_victory_effect = yes

		# EP2 accolade glory gain for winning against higher ranked enemy
		scope:attacker = { accolade_attacker_war_end_glory_gain_low_effect = yes }

		create_title_and_vassal_change = {
			type = conquest
			save_scope_as = change
			add_claim_on_loss = yes
		}

		# Grab the designated county.
		every_in_list = {
			list = target_titles
			change_title_holder = {
				holder = scope:attacker
				change = scope:change
			}
		}

		resolve_title_and_vassal_change = scope:change

		# Prestige Progress for the Attacker
		every_in_list = {
			list = target_titles
			scope:attacker = {
				add_prestige_experience = minor_prestige_value
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker
			FAME_BASE = minor_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		# Truce
		add_truce_attacker_victory_effect = yes

		# FP1: note the victory for future memorialisation via stele (if applicable).
		scope:attacker = { fp1_remember_recent_conquest_victory_effect = yes }
	}

	on_white_peace_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = county_conquest_cb_white_peace_desc_defender
			}
			desc = county_conquest_cb_white_peace_desc
		}
	}

	on_white_peace = {
		scope:attacker = { show_pow_release_message_effect = yes }
		# Prestige loss for the attacker
		scope:attacker = {
			add_prestige = {
				value = minor_prestige_value
				multiply = -1.0
			}
			add_stress = medium_stress_impact_gain
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker # Not important as the scales are identical
			FAME_BASE = minor_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		scope:defender = {
			stress_impact = {
 				arrogant = medium_stress_impact_gain
 			}
		}

		add_truce_white_peace_effect = yes
	}

	on_defeat_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = county_conquest_cb_defeat_desc_defender
			}
			triggered_desc = {
				trigger = {
					scope:attacker = {
						is_local_player = yes
						has_targeting_faction = yes
					}
				}
				desc = county_conquest_cb_defeat_desc_attacker
			}
			desc = county_conquest_cb_defeat_desc
		}
	}

	on_defeat = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		# Legitimacy
		add_legitimacy_attacker_defeat_effect = yes

		# Influence
		add_influence_attacker_defeat_effect = yes

		# EP2 accolade glory gain for winning against higher ranked enemy
		scope:defender = { accolade_defender_war_end_glory_gain_low_effect = yes }

		# Prestige loss for the attacker
		scope:attacker = {
			pay_short_term_gold_reparations_effect = {
				GOLD_VALUE = 2
			}
			add_prestige = medium_prestige_loss
		}

		# Prestige for Defender
		scope:defender = {
			add_prestige_war_defender_effect = {
				PRESTIGE_VALUE = medium_prestige_value
			}
		}

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:defender
			FAME_BASE = minor_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		add_truce_attacker_defeat_effect = yes

		scope:attacker = {
			save_temporary_scope_as = loser
		}
		on_lost_aggression_war_discontent_loss = yes
	}

	transfer_behavior = transfer

	on_primary_attacker_death = inherit
	on_primary_defender_death = inherit

	attacker_allies_inherit = yes
	defender_allies_inherit = yes

	war_name = "GEROIAN_CONSOLIDATION_WAR_NAME"
	war_name_base = "GEROIAN_CONSOLIDATION_WAR_NAME_BASE"
	cb_name = "GEROIAN_CONSOLIDATION_COUNTY_CB_NAME"

	interface_priority = 83

	use_de_jure_wargoal_only = yes

	attacker_wargoal_percentage = 0.8
	
	max_defender_score_from_occupation = 150
	max_attacker_score_from_occupation = 150
}
#####
# RHODOK CB
#####
rhodok_war = {
	icon = independence_faction_war
	group = invasion

	combine_into_one = yes
	should_show_war_goal_subview = yes
	mutually_exclusive_titles = { always = yes }
	allow_hostages = yes

	allowed_for_character = {
		scope:attacker = {
			has_character_flag = rhodok_re_leader
		}
	}

	target_titles = all
	target_title_tier = kingdom
	target_de_jure_regions_above = yes
	ignore_effect = change_title_holder


#	should_invalidate = {
#		
#	}

	on_invalidated_desc = msg_invasion_war_invalidated_message
	
#	on_invalidated = {
#
#	}

	cost = {
	}
	
	on_declaration = {
		on_declared_war = yes
		scope:attacker = {
			add_character_flag = rhodok_leader
			every_held_title = {
				limit = {
					tier >= tier_county
				}
				set_variable = untouchable_title_var
			}
		}
	}	

	on_victory_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:attacker = { is_local_player = yes } }
				desc = invasion_war_victory_desc_attacker
			}
			desc = invasion_war_victory_desc
		}
	}
	
	on_victory = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		#scope:attacker = { get_title = title:k_rhodok }
		
		# Legitimacy
		add_legitimacy_attacker_victory_effect = yes

		#EP2 accolade glory gain for winning against higher ranked enemy
		scope:attacker = { accolade_attacker_war_end_glory_gain_high_effect = yes }

		scope:attacker = {
			trigger_event = {
				id = ck_global_culture.3000
				days = 1
			}
		}

		create_title_and_vassal_change = {
			type = conquest
			save_scope_as = change
			add_claim_on_loss = yes
		}
		
		if = { ### In case scope:attacker is landless Grunwalder
			limit = {
				scope:attacker = {
					has_character_flag = is_grunwalder
				}
			}
			scope:attacker.primary_title = {
				save_scope_as = grunwalder_host
			}
			destroy_title = scope:grunwalder_host
			random_county_in_region = {
				region = region_rhodok_culture
				limit = {
					holder.top_liege = {
						has_title = title:k_vlandia
					}
					holder = {
						is_ai = yes
					}
				}
				save_scope_as = tempor_capital
			}
			scope:attacker = {
				get_title = scope:tempor_capital
				get_title = title:k_rhodok
			}
		}
		if = {
			limit = {
				scope:attacker = {
					NOT = {
						has_character_flag = is_grunwalder
					}
				}
			}
			scope:attacker = { get_title = title:k_rhodok }
		}
		
		
		show_as_tooltip = {
			every_in_list = {
				list = target_titles
				every_in_de_jure_hierarchy = {
					if = {
						limit = {
							holder ?= {
								has_culture = culture:swadian
							}
							NOT = {
								this = title:c_acrion
							}
						}
						change_title_holder = {
							holder = scope:attacker
							change = scope:change
						}
					}
				}
			}
			scope:defender = {
				every_sub_realm_county = {
					limit = {
						county_controller = scope:attacker
					}
					change_title_holder = {
						holder = scope:attacker
						change = scope:change
					}
				}
			}
		}
		
		hidden_effect = {
			scope:attacker = {
				trigger_event = {
					id = ck_global_culture.0011
					days = { 4 10 }
				}
			}
			scope:defender = {
				trigger_event = ck_global_culture.0013
			}
			title:k_vlandia = {
				holder = {
					save_scope_as = vlandiaking
				}
			}
			every_in_list = {
				list = target_titles
				every_in_de_jure_hierarchy = {
					if = {
						limit = {
							holder ?= {
								has_culture = culture:swadian
								any_liege_or_above = {
									has_title = title:k_vlandia
								}
								is_ai = yes
							}
						}
						change_title_holder = {
							holder = scope:attacker
							change = scope:change
						}
					}
				}
			}
			every_in_list = {
				list = target_titles
				every_in_de_jure_hierarchy = {
					if = {
						limit = {
							holder ?= {
								has_culture = culture:swadian
								any_liege_or_above = {
									has_title = title:k_vlandia
								}
								is_ai = no
							}
						}
						change_liege = {
							liege = scope:attacker
							change = scope:change
						}
						trigger_event = {
							id = ck_global_culture.0010
						}
					}
				}
			}
			scope:defender = {
				every_sub_realm_county = {
					limit = {
						county_controller = scope:attacker
					}
					change_title_holder = {
						holder = scope:attacker
						change = scope:change
					}
				}
			}
			every_ruler = {
				limit = {	
					capital_province = {
						geographical_region = region_rhodokia
					}
					is_vassal_or_below_of = scope:vlandiaking
					NOT = {
						has_culture = culture:swadian
					}
				}
				change_liege = {
					liege = scope:attacker
					change = scope:change
				}
			}
			
			setup_invasion_cb = {
				titles = target_titles
				attacker = scope:attacker
				defender = scope:defender
				change = scope:change
				take_occupied = yes
			}
			resolve_title_and_vassal_change = scope:change
		}

		# Attacker gets Prestige Experience, Defender loses Prestige, all other participants gain Prestige based on their war contribution.
		modify_all_participants_fame_values = {
			WINNER = scope:attacker
			LOSER = scope:defender
			FAME_BASE = scope:cb_prestige_factor # Set by 'setup_invasion_cb'
			IS_RELIGIOUS_WAR = no
			WINNER_FAME_SCALE = 10
			LOSER_FAME_SCALE = -10
			WINNER_ALLY_FAME_SCALE = 10
			LOSER_ALLY_FAME_SCALE = 10
		}

		# Truce
		add_truce_attacker_victory_effect = yes

		# FP1: note the victory for future memorialisation via stele (if applicable).
		scope:attacker = { fp1_remember_recent_conquest_victory_effect = yes }
	}

	on_white_peace_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = invasion_war_white_peace_desc_defender
			}
			desc = invasion_war_white_peace_desc
		}
	}
	
	on_white_peace = {
		scope:attacker = { show_pow_release_message_effect = yes }

		#EP2 accolade glory gain for doing ok against higher ranked enemy
		scope:attacker = { accolade_attacker_war_end_glory_gain_low_effect = yes }
		scope:defender = { accolade_defender_war_end_glory_gain_med_effect = yes }

		# Allies on both sides get full prestige value for helping in the war, based on their war participation.
		modify_allies_of_participants_fame_values = {
			WINNER = scope:attacker # Not important as the scales are identical
			FAME_BASE = major_prestige_value
			IS_RELIGIOUS_WAR = no
			WINNER_ALLY_FAME_SCALE = 1
			LOSER_ALLY_FAME_SCALE = 1
		}

		# Truce
		add_truce_white_peace_effect = yes

		scope:attacker = {
			add_prestige = mongol_invasion_cb_prestige_white_peace
			stress_impact = {
				ambitious = medium_stress_impact_gain
				arrogant = medium_stress_impact_gain
			}
		}

		scope:defender = {
			stress_impact = {
				arrogant = medium_stress_impact_gain
			}
		}
	}

	on_defeat_desc = {
		first_valid = {
			triggered_desc = {
				trigger = { scope:defender = { is_local_player = yes } }
				desc = invasion_war_white_peace_desc_defender
			}
			desc = invasion_war_white_peace_desc
		}
	}
	
	on_defeat = {
		scope:attacker = { show_pow_release_message_effect = yes }
		
		# Legitimacy
		add_legitimacy_attacker_defeat_effect = yes

		#EP2 accolade glory gain for winning against higher ranked enemy
		scope:defender = { accolade_defender_war_end_glory_gain_high_effect = yes }

		# Prestige loss for the attacker
		scope:attacker = {
			pay_short_term_gold_reparations_effect = {
				GOLD_VALUE = 5
			}
			add_prestige = {
				value = massive_prestige_value
				multiply = -1.0
			}
		}
		
		setup_invasion_cb = {
			titles = target_titles
			attacker = scope:attacker
			defender = scope:defender
			claimant = scope:claimant
			victory = no
		}

		# Attacker loses Prestige, all other war participants gain Prestige (Defender gains full prestige, all allies on both sides gain based on war contribution).
		modify_all_participants_fame_values = {
			WINNER = scope:defender
			LOSER = scope:attacker
			FAME_BASE = scope:cb_prestige_factor # Set by 'setup_claim_cb'
			IS_RELIGIOUS_WAR = no
			WINNER_FAME_SCALE = scale_10_war_defender_win
			LOSER_FAME_SCALE = -10
			WINNER_ALLY_FAME_SCALE = 10
			LOSER_ALLY_FAME_SCALE = 10
		}
	
		add_truce_attacker_defeat_effect = yes
		
		scope:attacker = {
			save_temporary_scope_as = loser
		}
		on_lost_aggression_war_discontent_loss = yes
	}
	
	transfer_behavior = transfer
	
	on_primary_attacker_death = inherit
	on_primary_defender_death = inherit
	
	attacker_allies_inherit = yes
	defender_allies_inherit = yes
	
	war_name = "RHODOK_WAR_NAME"
	war_name_base = "RHODOK_WAR_NAME_BASE"
	cb_name = "RHODOK_CB_NAME"
	
	interface_priority = 100
	
	use_de_jure_wargoal_only = yes
	
	attacker_wargoal_percentage = 0.8
	
	max_defender_score_from_occupation = 70
	max_attacker_score_from_occupation = 200
	
	max_attacker_score_from_battles = 150
	max_defender_score_from_battles = 100
	
	attacker_score_from_battles_scale = 225 
	
	attacker_score_from_occupation_scale = 200
	defender_score_from_occupation_scale = 50
	
}
