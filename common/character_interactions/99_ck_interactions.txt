#############################
### Imperial Interactions ###
# Demand change of an imperial faction #
demand_change_senatorial_faction = { 
	category = interaction_category_vassal
	interface_priority = 110
	icon = council
	desc = demand_change_senatorial_faction_desc
	common_interaction = yes

	popup_on_receive = yes
	pause_on_receive = yes

	ai_min_reply_days = 1
	ai_max_reply_days = 7
	
	cooldown_against_recipient = { months = 12 } 
	
	#notification_text = {
	#	desc = demand_change_senatorial_faction_notification_desc
	#}
	
	is_shown = {
		scope:recipient = {
			is_vassal_of = scope:actor
			OR = {
				has_trait = ck_oligarch
				has_trait = ck_populist
				has_trait = ck_militarist
				has_trait = ck_royalist
			}
		}
		scope:actor = {
			culture = {
				has_cultural_pillar = heritage_calradian
			}
			highest_held_title_tier = tier_empire
			OR = {
				has_trait = ck_oligarch
				has_trait = ck_populist
				has_trait = ck_militarist
				has_trait = ck_royalist
			}
		}
		scope:actor != scope:recipient
	}
	
	is_valid_showing_failures_only = {
		scope:recipient = {
			is_adult = yes
			NOR = {
				is_at_war_with = scope:actor
				has_relation_rival = scope:actor
				has_relation_nemesis = scope:actor
				has_opinion_modifier = {
					target = scope:actor
					modifier = released_from_prison
				}
				existing_feud_against_target_trigger = { TARGET = scope:actor }
			}
		}
		#Disabled/Enabled for test purposes
		custom_tooltip = {
			text = already_supports_your_faction_tt
			NAND = {
				scope:recipient = { has_trait = ck_militarist }
				scope:actor = { has_trait = ck_militarist }
			}
		}
		custom_tooltip = {
			text = already_supports_your_faction_tt
			NAND = {
				scope:recipient = { has_trait = ck_populist }
				scope:actor = { has_trait = ck_populist }
			}
		}
		custom_tooltip = {
			text = already_supports_your_faction_tt
			NAND = {
				scope:recipient = { has_trait = ck_oligarch }
				scope:actor = { has_trait = ck_oligarch }
			}
		}
		custom_tooltip = {
			text = already_supports_your_faction_tt
			NAND = {
				scope:recipient = { has_trait = ck_royalist }
				scope:actor = { has_trait = ck_royalist }
			}
		}
		custom_tooltip = {
			text = demanded_recently_tt
			NOT = {
				scope:actor = {
					has_character_flag = demanded_faction_change_flag
				}
			}
		}
	}
	
	is_highlighted = {
		scope:actor = {
			is_character_interaction_potentially_accepted = {
				recipient = scope:recipient
				interaction = contact_list_request_interaction
			}
		}
	}
	can_be_picked = {
		NOT = { scope:recipient = root }
	}
	
	#Gold bribe small
	send_option = {
		flag = bribe_with_gold_small
		is_valid = {
			custom_tooltip = {
				scope:actor.gold > 70
				text = demand_change_senatorial_faction.not_enough_gold
			}
		}
	}
	#Gold bribe big
	send_option = {
		flag = bribe_with_gold_big
		is_valid = {
			custom_tooltip = {
				scope:actor.gold > 400
				text = demand_change_senatorial_faction.not_enough_gold
			}
		}
	}
	#Favor bribe
	send_option = {
		flag = bribe_with_favor
		is_valid = {
			custom_tooltip = {
				NOR = {
					scope:recipient = {
						has_hook = scope:actor
					}
					scope:actor = {
						has_character_flag = AI_gave_favor_cooldown
					}
				}
				text = demand_change_senatorial_faction.already_has_hook
			}
		}
	}
	#Intimidate
	send_option = {
		flag = bribe_with_dread
		is_valid = {
			custom_tooltip = {
				scope:actor = {
					dread > 75
				}
				text = demand_change_senatorial_faction.not_enough_dread
			}
		}
	}
	#Goodwill
	send_option = {
		flag = bribe_with_opinion
		is_valid = {
			custom_tooltip = {
				scope:recipient = {
					opinion = {
						target = scope:actor
						value = 100
					}
				}
				text = demand_change_senatorial_faction.not_enough_opinion
			}
		}
	}
	#Has Hook
	send_option = {
		flag = demand_with_hook
		is_valid = {
			custom_tooltip = {
				scope:actor = {
					has_hook = scope:recipient
				}
				text = demand_change_senatorial_faction.no_hook_avaible
			}
		}
	}
	
	should_use_extra_icon = {
		scope:actor = { has_usable_hook = scope:recipient }
	}
	extra_icon = "gfx/interface/icons/character_interactions/hook_icon.dds"
	
	cost = {
		prestige = {
			value = 100
		}
	}
	on_accept = {
		scope:actor = {
			switch = {
				trigger = yes
				scope:bribe_with_gold_small ?= {
					scope:actor = {
						trigger_event = ck_imperial_events.0002
						pay_short_term_gold = {
							target = scope:recipient
							gold = 70
						}
						custom_tooltip = {
							add_character_flag = {
								flag = demanded_faction_change_flag
								years = 2
							}
							text = demand_cooldown_tt
						}
					}
					scope:recipient = {
						add_prestige = -200
						add_character_modifier = {
							modifier = bribed_interaction
							years = 5
						}
						add_opinion = {
							modifier = demanded_faction_change
							years = 2
							target = scope:actor
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_oligarch
							}
						}
						scope:recipient = {
							custom_tooltip = {
								#remove_trait = ck_oligarch
								remove_trait = ck_militarist
								remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_oligarch
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_militarist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								#remove_trait = ck_militarist
								remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_militarist
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_populist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								remove_trait = ck_militarist
								#remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_populist
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_royalist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								remove_trait = ck_militarist
								remove_trait = ck_populist
								#remove_trait = ck_royalist
								add_trait = ck_royalist
								
								text = will_change_faction
							}
						}
					}
					scope:recipient = {
						custom_tooltip = {
							add_character_flag = {
								flag = changed_faction_from_demand
								years = 20
							}
							text = will_not_change_faction_tt
						}
					}
				}
				scope:bribe_with_gold_big ?= {
					scope:actor = {
						trigger_event = ck_imperial_events.0002
						pay_short_term_gold = {
							target = scope:recipient
							gold = 400
						}
						custom_tooltip = {
							add_character_flag = {
								flag = demanded_faction_change_flag
								years = 2
							}
							text = demand_cooldown_tt
						}
					}
					scope:recipient = {
						add_prestige = -200
						add_character_modifier = {
							modifier = bribed_interaction
							years = 5
						}
						add_opinion = {
							modifier = demanded_faction_change
							years = 2
							target = scope:actor
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_oligarch
							}
						}
						scope:recipient = {
							custom_tooltip = {
								#remove_trait = ck_oligarch
								remove_trait = ck_militarist
								remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_oligarch
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_militarist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								#remove_trait = ck_militarist
								remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_militarist
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_populist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								remove_trait = ck_militarist
								#remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_populist
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_royalist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								remove_trait = ck_militarist
								remove_trait = ck_populist
								#remove_trait = ck_royalist
								add_trait = ck_royalist
								
								text = will_change_faction
							}
						}
					}
					scope:recipient = {
						custom_tooltip = {
							add_character_flag = {
								flag = changed_faction_from_demand
								years = 20
							}
							text = will_not_change_faction_tt
						}
					}
				}
				scope:bribe_with_favor ?= {
					scope:actor = {
						trigger_event = ck_imperial_events.0002
						add_prestige = -100
						custom_tooltip = {
							add_character_flag = {
								flag = demanded_faction_change_flag
								years = 2
							}
							text = demand_cooldown_tt
						}
					}
					scope:recipient = {
						add_prestige = -200
						add_character_modifier = {
							modifier = bribed_interaction
							years = 5
						}
						add_opinion = {
							modifier = demanded_faction_change
							years = 2
							target = scope:actor
						}
						add_hook = {
							target = scope:actor
							type = favor_hook
							years = 5
						}
					}
					if = {
						limit = {
							scope:actor = {
								is_ai = yes
							}
						}
						scope:actor = {
							add_character_flag = {
								flag = AI_gave_favor_cooldown
								years = 4
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_oligarch
							}
						}
						scope:recipient = {
							custom_tooltip = {
								#remove_trait = ck_oligarch
								remove_trait = ck_militarist
								remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_oligarch
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_militarist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								#remove_trait = ck_militarist
								remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_militarist
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_populist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								remove_trait = ck_militarist
								#remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_populist
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_royalist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								remove_trait = ck_militarist
								remove_trait = ck_populist
								#remove_trait = ck_royalist
								add_trait = ck_royalist
								
								text = will_change_faction
							}
						}
					}
					scope:recipient = {
						custom_tooltip = {
							add_character_flag = {
								flag = changed_faction_from_demand
								years = 20
							}
							text = will_not_change_faction_tt
						}
					}
				}
				scope:bribe_with_dread ?= {
					scope:actor = {
						trigger_event = ck_imperial_events.0002
						add_tyranny = 25
						add_prestige = -250
						custom_tooltip = {
							add_character_flag = {
								flag = demanded_faction_change_flag
								years = 2
							}
							text = demand_cooldown_tt
						}
					}
					scope:recipient = {
						add_prestige = -100
						add_opinion = {
							modifier = demanded_faction_change_major
							years = 7
							target = scope:actor
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_oligarch
							}
						}
						scope:recipient = {
							custom_tooltip = {
								#remove_trait = ck_oligarch
								remove_trait = ck_militarist
								remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_oligarch
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_militarist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								#remove_trait = ck_militarist
								remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_militarist
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_populist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								remove_trait = ck_militarist
								#remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_populist
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_royalist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								remove_trait = ck_militarist
								remove_trait = ck_populist
								#remove_trait = ck_royalist
								add_trait = ck_royalist
								
								text = will_change_faction
							}
						}
					}
					scope:recipient = {
						custom_tooltip = {
							add_character_flag = {
								flag = changed_faction_from_demand
								years = 20
							}
							text = will_not_change_faction_tt
						}
					}
				}
				scope:bribe_with_opinion ?= {
					scope:actor = {
						trigger_event = ck_imperial_events.0002
						custom_tooltip = {
							add_character_flag = {
								flag = demanded_faction_change_flag
								years = 2
							}
							text = demand_cooldown_tt
						}
					}
					scope:recipient = {
						add_prestige = -100
						add_opinion = {
							modifier = demanded_faction_change
							years = 2
							target = scope:actor
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_oligarch
							}
						}
						scope:recipient = {
							custom_tooltip = {
								#remove_trait = ck_oligarch
								remove_trait = ck_militarist
								remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_oligarch
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_militarist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								#remove_trait = ck_militarist
								remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_militarist
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_populist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								remove_trait = ck_militarist
								#remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_populist
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_royalist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								remove_trait = ck_militarist
								remove_trait = ck_populist
								#remove_trait = ck_royalist
								add_trait = ck_royalist
								
								text = will_change_faction
							}
						}
					}
					scope:recipient = {
						custom_tooltip = {
							add_character_flag = {
								flag = changed_faction_from_demand
								years = 20
							}
							text = will_not_change_faction_tt
						}
					}
				}
				scope:demand_with_hook ?= {
					scope:actor = {
						use_hook = scope:recipient
						trigger_event = ck_imperial_events.0002
						custom_tooltip = {
							add_character_flag = {
								flag = demanded_faction_change_flag
								years = 2
							}
							text = demand_cooldown_tt
						}
					}
					scope:recipient = {
						add_prestige = -100
						add_opinion = {
							modifier = demanded_faction_change
							years = 2
							target = scope:actor
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_oligarch
							}
						}
						scope:recipient = {
							custom_tooltip = {
								#remove_trait = ck_oligarch
								remove_trait = ck_militarist
								remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_oligarch
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_militarist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								#remove_trait = ck_militarist
								remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_militarist
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_populist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								remove_trait = ck_militarist
								#remove_trait = ck_populist
								remove_trait = ck_royalist
								add_trait = ck_populist
								
								text = will_change_faction
							}
						}
					}
					if = {
						limit = {
							scope:actor = {
								has_trait = ck_royalist
							}
						}
						scope:recipient = {
							custom_tooltip = {
								remove_trait = ck_oligarch
								remove_trait = ck_militarist
								remove_trait = ck_populist
								#remove_trait = ck_royalist
								add_trait = ck_royalist
								
								text = will_change_faction
							}
						}
					}
					scope:recipient = {
						custom_tooltip = {
							add_character_flag = {
								flag = changed_faction_from_demand
								years = 20
							}
							text = will_not_change_faction_tt
						}
					}
				}
			}
		}
	}
	ai_frequency = 10
	ai_targets = { ai_recipients = vassals }
	ai_potential = {
		ai_honor < 20
	}
	ai_will_do = {
		base = 45
		modifier = {
			scope:actor = {
				has_trait = ambitious
				has_trait = deceitful
			}
			add = 50
		}
		modifier = {
			scope:actor = {
				has_trait = just
				has_trait = content
			}
			add = -30
		}
		modifier = {
			scope:actor = {
				OR = {
					is_at_war = yes
					is_imprisoned = yes
				}
			}
			add = -100
		}
	}
	ai_accept = {
		base = -30
		
		### General modifiers, applies to every request ###
		modifier = { #Is fickle # +30
			add = 30
			desc = forced_to_change_faction.acceptance.fickle
			scope:recipient = {
				has_trait = fickle
			}
		}
		modifier = { #Friends or best friends # +30
			add = 30
			desc = forced_to_change_faction.acceptance.friend_or_best_friend
			scope:recipient = {
				OR = {
					has_relation_friend = scope:actor
					has_relation_best_friend = scope:actor
				}
			}
		}
		modifier = { #Opinion above 50 # +20
			add = 20
			desc = forced_to_change_faction.acceptance.good_opinion
			scope:recipient = {
				opinion = {
					target = scope:actor
					value >= 50
				}
			}
		}
		modifier = { #Specific acceptance traits # +20
			add = 20
			desc = forced_to_change_faction.acceptance.general_traits_accept
			scope:recipient = {
				OR = {
					has_trait = deceitful
					has_trait = arbitrary
					has_trait = trusting
				}
			}
		}
		modifier = { #Is disloyal # +20
			add = 20
			desc = forced_to_change_faction.acceptance.disloyal
			scope:recipient = {
				has_trait = disloyal
			}
		}
		modifier = { #Is councillor of sender # +10
			add = 10
			desc = forced_to_change_faction.acceptance.councillor
			scope:recipient = {
				is_councillor_of = scope:actor
			}
		}
		modifier = { #Is powerful vassal # -15
			add = -15
			desc = forced_to_change_faction.acceptance.powerful_vassal
			scope:recipient = {
				is_powerful_vassal = yes
			}
		}
		modifier = { #Specific rejection traits # -20
			add = -20
			desc = forced_to_change_faction.acceptance.general_traits_reject
			scope:recipient = {
				OR = {
					has_trait = ambitious
					has_trait = just
					has_trait = content
				}
			}
		}
		modifier = { #Is loyal # -20
			add = -20
			desc = forced_to_change_faction.acceptance.loyal
			scope:recipient = {
				has_trait = loyal
			}
		}
		modifier = { #Opinion below -30 # -20
			add = -20
			desc = forced_to_change_faction.acceptance.bad_opinion
			scope:recipient = {
				opinion = {
					target = scope:actor
					value <= -30
				}
			}
		}
		modifier = { #Is stubborn # -30
			add = -30
			desc = forced_to_change_faction.acceptance.stubborn
			scope:recipient = {
				has_trait = stubborn
			}
		}

		### Gold bribe modifiers ###
		modifier = { #Small bribe # +10
			add = 10
			desc = forced_to_change_faction.acceptance.this_offer.1
			scope:bribe_with_gold_small ?= yes
		}
		modifier = { #Big bribe # +36
			add = 36
			desc = forced_to_change_faction.acceptance.this_offer.2
			scope:bribe_with_gold_big ?= yes
		}
		modifier = { #Is greedy # +40
			add = 40
			desc = forced_to_change_faction.acceptance.greedy
			scope:recipient = {
				has_trait = greedy
			}
			OR = {
				scope:bribe_with_gold_big ?= yes
				scope:bribe_with_gold_small ?= yes
			}
		}
		modifier = { #Is content # -20
			add = -20
			desc = forced_to_change_faction.acceptance.content
			scope:recipient = {
				has_trait = content
			}
			OR = {
				scope:bribe_with_gold_big ?= yes
				scope:bribe_with_gold_small ?= yes
			}
		}
		modifier = { #Bribe too small # -30
			add = -30
			desc = forced_to_change_faction.acceptance.too_small_bribe
			scope:recipient = {
				gold >= 50
			}
			scope:bribe_with_gold_small ?= yes
		}
		modifier = { #Too rich to bribe # -75
			add = -75
			desc = forced_to_change_faction.acceptance.too_rich
			scope:recipient = {
				gold >= 650
			}
			OR = {
				scope:bribe_with_gold_big ?= yes
				scope:bribe_with_gold_small ?= yes
			}
		}
		
		### Favor modifiers ###
		modifier = { #Hook on liege is useful, no? # +70
			add = 70
			desc = forced_to_change_faction.acceptance.favor
			scope:bribe_with_favor ?= yes
		}
		modifier = { #Is content # -20
			add = -20
			desc = forced_to_change_faction.acceptance.content
			scope:recipient = {
				has_trait = content
			}
			scope:bribe_with_favor ?= yes
		}
		
		### Intimidation modifiers ###
		modifier = { #Intimidation # +50
			add = 50
			desc = forced_to_change_faction.acceptance.this_offer.3
			scope:bribe_with_dread ?= yes
		}
		modifier = { #Is craven # +50
			add = 50
			desc = forced_to_change_faction.acceptance.craven
			scope:recipient = {
				has_trait = craven
			}
			scope:bribe_with_dread ?= yes
		}
		modifier = { #Is paranoid # +20
			add = 20
			desc = forced_to_change_faction.acceptance.paranoid
			scope:recipient = {
				has_trait = paranoid
			}
			scope:bribe_with_dread ?= yes
		}
		modifier = { #Is brave # -75
			add = -75
			desc = forced_to_change_faction.acceptance.brave
			scope:recipient = {
				has_trait = brave
			}
			scope:bribe_with_dread ?= yes
		}
		
		### Goodwill modifiers ###
		modifier = { #This offer # +35
			add = 35
			desc = forced_to_change_faction.acceptance.this_offer.4
			scope:bribe_with_opinion ?= yes
		}
		
		### Hook modifiers ###
		modifier = { #This offer # +500
			add = 500
			desc = forced_to_change_faction.acceptance.this_offer.5
			scope:demand_with_hook ?= yes
		}
		
	}
	on_decline = {
		scope:actor = {
			trigger_event = ck_imperial_events.0003
		}
	}
	auto_accept = {
		scope:actor = { has_usable_hook = scope:recipient }
		scope:actor = { is_ai = yes }
		scope:recipient = { is_ai = no }
	}
	on_auto_accept = {
		scope:recipient = {
			send_interface_toast = {
				type = event_toast_effect_bad
				title = forced_to_change_faction.tt.title
				right_icon = scope:actor
				custom_tooltip = forced_to_change_faction.tt.desc
			}
		}
	}

}

# Invite to Imperial Expedition #
invite_to_expedition = {
	category = interaction_category_vassal
	interface_priority = 120
	icon = icon_coax_to_war
	desc = invite_to_expedition_desc
	common_interaction = yes
	
	popup_on_receive = yes
	pause_on_receive = yes
	
	ai_min_reply_days = 0
	ai_max_reply_days = 0
	
	cooldown_against_recipient = { months = 6 }

	is_shown = {
		scope:actor = {
			is_ai = no
			has_character_flag = preparing_imperial_expedition
		}
		scope:recipient = {
			is_vassal_or_below_of = scope:actor
			is_ai = yes
		}
		scope:actor != scope:recipient
	}
	
	is_valid_showing_failures_only = {
		scope:recipient = {
			is_at_war = no
			NOR = {
				has_relation_rival = scope:actor
				has_relation_nemesis = scope:actor
			}
		}
		custom_tooltip = {
			text = already_vowed_to_participate_tt
			scope:recipient = {
				NOT = {
					has_character_flag = will_join_expedition
				}
			}
		}
	}
	
	#Offer nothing
	send_option = {
		flag = offer_nothing
	}
	#Offer bribe
	send_option = {
		flag = offer_bribe
		is_valid = {
			custom_tooltip = {
				scope:actor.gold > 200
				text = demand_change_senatorial_faction.not_enough_gold
			}
		}
	}
	#Offer favor
	send_option = {
		flag = offer_favor
		is_valid = {
			custom_tooltip = {
				NOT = {
					scope:recipient = {
						has_hook = scope:actor
					}
				}
				text = demand_change_senatorial_faction.already_has_hook
			}
		}
	}
	#Promise titles
	send_option = {
		flag = promise_title
	}
	#Has Hook
	send_option = {
		flag = demand_with_hook
		is_valid = {
			custom_tooltip = {
				scope:actor = {
					has_hook = scope:recipient
				}
				text = demand_change_senatorial_faction.no_hook_avaible
			}
		}
	}
	
	should_use_extra_icon = {
		scope:actor = { has_usable_hook = scope:recipient }
	}
	extra_icon = "gfx/interface/icons/character_interactions/hook_icon.dds"
	
	cost = {
		prestige = {
			value = 100
		}
	}
	
	on_accept = {
		scope:actor = {
			switch = {
				trigger = yes
				scope:offer_nothing ?= {
					scope:actor = {
						custom_tooltip = offer_nothing_tt
						trigger_event = {
							id = ck_imperial_events.0025
							days = { 2 6 }
						}
					}
					scope:recipient = {
						custom_tooltip = {
							text = will_join_expedition_tt
							add_character_flag = {
								flag = will_join_expedition
								years = 1
							}
						}
					}
				}
				scope:offer_bribe ?= {
					scope:actor = {
						trigger_event = {
							id = ck_imperial_events.0025
							days = { 2 6 }
						}
						pay_short_term_gold = {
							target = scope:recipient
							gold = 200
						}
					}
					scope:recipient = {
						custom_tooltip = {
							text = will_join_expedition_tt
							add_character_flag = {
								flag = will_join_expedition
								years = 1
							}
						}
					}
				}
				scope:offer_favor ?= {
					custom_tooltip = offer_favor_tt
					scope:actor = {
						trigger_event = {
							id = ck_imperial_events.0025
							days = { 2 6 }
						}
					}
					scope:recipient = {
						add_hook = {
							target = scope:actor
							type = favor_hook
							years = 5
						}
						custom_tooltip = {
							text = will_join_expedition_tt
							add_character_flag = {
								flag = will_join_expedition
								years = 1
							}
						}
					}
				}
				scope:promise_title ?= {
					scope:actor = {
						custom_tooltip = offer_title_tt
						trigger_event = {
							id = ck_imperial_events.0025
							days = { 2 6 }
						}
						add_character_flag = promised_title_expedition
					}
					scope:recipient = {
						add_character_modifier = is_promised_new_title_modifier
						custom_tooltip = {
							text = will_join_expedition_tt
							add_character_flag = {
								flag = will_join_expedition
								years = 1
							}
						}
						custom_tooltip = {
							text = was_promised_title_expedition_tt
							add_character_flag = {
								flag = was_promised_title_expedition
								years = 13
							}
						}
					}
				}
				scope:demand_with_hook ?= {
					scope:actor = {
						trigger_event = {
							id = ck_imperial_events.0025
							days = { 2 6 }
						}
						use_hook = scope:recipient
					}
					scope:recipient = {
						custom_tooltip = {
							text = will_join_expedition_tt
							add_character_flag = {
								flag = will_join_expedition
								years = 1
							}
						}
					}
				}
			}
		}
	}
	ai_accept = {
		base = -25
		
		### General modifiers - apply to every option
		
		modifier = { #Friends or best friends # +30
			add = 30
			desc = invite_to_expedition.acceptance.friend_or_best_friend
			scope:recipient = {
				OR = {
					has_relation_friend = scope:actor
					has_relation_best_friend = scope:actor
				}
			}
		}
		modifier = { #Ambitious trait # +25
			add = 25
			desc = invite_to_expedition.acceptance.ambitious
			scope:recipient = {
				has_trait = ambitious
			}
		}
		modifier = { #Is a militarist # +20
			add = 20
			desc = invite_to_expedition.acceptance.militarist
			scope:recipient = {
				has_trait = ck_militarist
			}
		}
		modifier = { #Opinion above 50 # +20
			add = 20
			desc = invite_to_expedition.acceptance.good_opinion
			scope:recipient = {
				opinion = {
					target = scope:actor
					value >= 50
				}
			}
		}
		modifier = { #Is loyal # +20
			add = 20
			desc = invite_to_expedition.acceptance.loyal
			scope:recipient = {
				has_trait = loyal
			}
		}
		modifier = { #Specific acceptance traits # +15
			add = 15
			desc = invite_to_expedition.acceptance.general_traits_accept
			scope:recipient = {
				OR = {
					has_trait = greedy
					has_trait = zealous
					has_trait = brave
				}
			}
		}
		modifier = { #Is councillor of sender # +10
			add = 10
			desc = invite_to_expedition.acceptance.councillor
			scope:recipient = {
				is_councillor_of = scope:actor
			}
		}
		modifier = { #Opinion below -30 # -20
			add = -20
			desc = invite_to_expedition.acceptance.bad_opinion
			scope:recipient = {
				opinion = {
					target = scope:actor
					value <= -30
				}
			}
		}
		modifier = { #Specific rejection traits # -25
			add = -25
			desc = invite_to_expedition.acceptance.general_traits_reject
			scope:recipient = {
				OR = {
					has_trait = temperate
					has_trait = content
					has_trait = lazy
					has_trait = paranoid
				}
			}
		}
		modifier = { #Is in debt # -60
			add = -60
			desc = invite_to_expedition.acceptance.debt
			scope:recipient = {
				gold < 0
			}
			scope:offer_bribe ?= no
		}
		modifier = { #Is craven # -100
			add = -100
			desc = invite_to_expedition.acceptance.craven
			scope:recipient = {
				has_trait = craven
			}
		}
		modifier = {
			add = -1000
			desc = invite_to_expedition.acceptance.broken_promise
			scope:recipient = {
				has_opinion_modifier = {
					target = scope:actor
					modifier = broken_promise_expedition_modifier
				}
			}
		}
		
		### Bribe modifiers ###
		modifier = { #Is greedy # +30
			add = 30
			desc = invite_to_expedition.acceptance.greedy
			scope:recipient = {
				has_trait = greedy
			}
			scope:offer_bribe ?= yes
		}
		modifier = { #Bribe # +50
			add = 50
			desc = invite_to_expedition.acceptance.this_offer
			scope:offer_bribe ?= yes
		}
		modifier = { #Is rich already # -60
			add = -60
			desc = invite_to_expedition.acceptance.too_rich
			scope:recipient = {
				gold >= 650
			}
			scope:offer_bribe ?= yes
		}
		
		### Favor modifiers ###
		modifier = { #Hook on liege is useful, no? # +70
			add = 70
			desc = forced_to_change_faction.acceptance.favor
			scope:offer_favor ?= yes
		}
		
		### Promise lands modifiers ###
		modifier = { #Wants new lands # +75
			add = 75
			desc = invite_to_expedition.acceptance.this_offer.2
			scope:promise_title ?= yes
		}
		modifier = { #Is greedy # +15
			add = 15
			desc = invite_to_expedition.acceptance.greedy.2
			scope:recipient = {
				has_trait = greedy
			}
			scope:promise_title ?= yes
		}
		modifier = { #Is content # -20
			add = -20
			desc = invite_to_expedition.acceptance.content
			scope:recipient = {
				has_trait = content
			}
			scope:promise_title ?= yes
		}
		modifier = { #At domain limit # -85
			add = -85
			desc = invite_to_expedition.acceptance.domain_limit
			scope:recipient = {
				highest_held_title_tier = tier_county
				domain_limit_available <= 0
			}
			scope:promise_title ?= yes
		}
		
		### Hook modifiers ###
		modifier = { #This offer # +500
			add = 500
			desc = forced_to_change_faction.acceptance.this_offer.5
			scope:demand_with_hook ?= yes
		}
		
		### Invited vassals modifiers ###
		modifier = { #Already invited two vassal # -15
			add = -15
			desc = invite_to_expedition.acceptance.two_vassals
			scope:actor = {
				any_vassal_or_below = {
					count = 2
					has_character_flag = will_join_expedition
				}
			}
		}
		modifier = { #Already invited three vassal # -30
			add = -30
			desc = invite_to_expedition.acceptance.three_vassals
			scope:actor = {
				any_vassal_or_below = {
					count = 3
					has_character_flag = will_join_expedition
				}
			}
		}
		modifier = { #Already invited four vassal # -40
			add = -40
			desc = invite_to_expedition.acceptance.four_vassals
			scope:actor = {
				any_vassal_or_below = {
					count = 4
					has_character_flag = will_join_expedition
				}
			}
		}
		modifier = { #Already invited five vassal # -50
			add = -50
			desc = invite_to_expedition.acceptance.five_vassals
			scope:actor = {
				any_vassal_or_below = {
					count = 5
					has_character_flag = will_join_expedition
				}
			}
		}
		modifier = { #Already invited six vassal # -60
			add = -60
			desc = invite_to_expedition.acceptance.six_vassals
			scope:actor = {
				any_vassal_or_below = {
					count = 6
					has_character_flag = will_join_expedition
				}
			}
		}
		modifier = { #Already invited seven and more vassal # -75
			add = -75
			desc = invite_to_expedition.acceptance.seven_and_above_vassals
			scope:actor = {
				any_vassal_or_below = {
					count >= 7
					has_character_flag = will_join_expedition
				}
			}
		}
	}
	
	is_highlighted = {
		scope:actor = {
			is_character_interaction_potentially_accepted = {
				recipient = scope:recipient
				interaction = contact_list_request_interaction
			}
		}
	}
	can_be_picked = {
		NOT = { scope:recipient = root }
	}
}

### Przypominajka, usuń potem
### Two interactions for gero coalition, one for AI, other for player.
### Military size of other rulers taken into account for AI
### Run through interaction effect
###

geroian_coalition_call_AI = {
	category = interaction_category_diplomacy
	desc = geroian_coalition_call
	interface_priority = 70
	popup_on_receive = yes
	pause_on_receive = yes
	icon = alliance
	greeting = positive
	
	ai_min_reply_days = 1
	ai_max_reply_days = 2
	
	is_shown = {
		scope:actor = {
			has_game_rule = ck_geroian_coalition_enabled
			is_ai = yes
			is_landed = yes
			culture = {
				has_cultural_pillar = heritage_geroian
			}
		}
	}
	
	is_valid_showing_failures_only = {
		scope:recipient = {
			NOT = {
				is_at_war_with = scope:actor
			}
			is_imprisoned = no
		}
		
	}
	can_be_picked = {
		NOT = { scope:recipient = root }
	}
	ai_accept = {
		base = 20
		
		modifier = { # 75% of Geroia occupied by foreigners # +100
			add = 1000
			desc = geroian_coalition_call.acceptance.75percent
			any_county_in_region = {
				region = region_geroia
				percent >= 0.75
				holder.top_liege = {
					NOT = {
						culture = {
							has_cultural_pillar = heritage_geroian
						}
					}
				}
			}
		}
		modifier = { # 50% of Geroia occupied by foreigners # +50
			add = 50
			desc = geroian_coalition_call.acceptance.50percent
			any_county_in_region = {
				region = region_geroia
				percent >= 0.5
				holder.top_liege = {
					NOT = {
						culture = {
							has_cultural_pillar = heritage_geroian
						}
					}
				}
			}
			any_county_in_region = {
				region = region_geroia
				percent < 0.75
				holder.top_liege = {
					NOT = {
						culture = {
							has_cultural_pillar = heritage_geroian
						}
					}
				}
			}
		}
		modifier = { # 25% of Geroia occupied by foreigners # +25
			add = 25
			desc = geroian_coalition_call.acceptance.25percent
			any_county_in_region = {
				region = region_geroia
				percent < 0.5
				holder.top_liege = {
					NOT = {
						culture = {
							has_cultural_pillar = heritage_geroian
						}
					}
				}
			}
			any_county_in_region = {
				region = region_geroia
				percent >= 0.25
				holder.top_liege = {
					NOT = {
						culture = {
							has_cultural_pillar = heritage_geroian
						}
					}
				}
			}
		}
		modifier = { #Is theocratic # +50
			add = 50
			desc = geroian_coalition_call.acceptance.theocratic
			scope:recipient = {
				NOT = {
					has_faith = faith:aekekartel
				}
				government_has_flag = government_is_theocracy
			}
		}
		modifier = { #Friends or best friends # +50
			add = 50
			desc = geroian_coalition_call.acceptance.friend_or_best_friend
			scope:recipient = {
				OR = {
					has_relation_friend = scope:actor
					has_relation_best_friend = scope:actor
				}
			}
		}
		modifier = { #Uniting against the Empire # +50
			add = 50
			desc = geroian_coalition_call.acceptance.empire
			exists = title:e_calradian_empire.holder
			scope:actor = {
				is_at_war_with = title:e_calradian_empire.holder
			}
		}
		modifier = { #Traits # +20
			add = 20
			desc = geroian_coalition_call.acceptance.general_traits_accept
			scope:recipient = {
				OR = {
					has_trait = brave
					has_trait = ambitious
					has_trait = loyal
					has_trait = compassionate
					has_trait = zealous
				}
			}
		}
		modifier = { #Opinion above 50 # +20
			add = 20
			desc = geroian_coalition_call.acceptance.good_opinion
			scope:recipient = {
				opinion = {
					target = scope:actor
					value >= 50
				}
			}
		}
		modifier = { #Neighbour # +20
			add = 20
			desc = geroian_coalition_call.acceptance.neighbour
			scope:recipient = {
				NOT = {
					is_vassal_or_below_of = scope:actor
				}
				any_sub_realm_title = {
					is_neighbor_to_realm = scope:actor
				}
			}
		}
		modifier = { #Military more powerful than sender # +15
			add = 15
			desc = geroian_coalition_call.acceptance.military_powerful
			scope:recipient = {
				current_military_strength > scope:actor.current_military_strength
			}
		}
		modifier = { #Weaker military than sender # -10
			add = -10
			desc = geroian_coalition_call.acceptance.military_weak
			scope:recipient = {
				current_military_strength < scope:actor.current_military_strength
			}
		}
		modifier = { #Foreign vassal # -15
			add = -15
			desc = geroian_coalition_call.acceptance.vassal
			scope:recipient = {
				is_independent_ruler = no
				NOT = {
					is_vassal_or_below_of = scope:actor
				}
			}
		}
		modifier = { #Ilegitimate ruler # -20
			add = -20
			desc = geroian_coalition_call.acceptance.low_legitimacy
			scope:actor = {
				legitimacy_level = 0
			}
		}
		modifier = { #General traits # -25
			add = -25
			desc = geroian_coalition_call.acceptance.general_traits_reject
			scope:recipient = {
				OR = {
					has_trait = reclusive
					has_trait = cynical
					has_trait = deceitful
				}
			}
		}
		modifier = { #Negative opinion # -30
			add = -30
			desc = geroian_coalition_call.acceptance.negative_opinion
			scope:recipient = {
				opinion = {
					target = scope:actor
					value <= -50
				}
			}
		}
		modifier = { # Im your vassal/you already take my levies # -30
			add = -30
			desc = geroian_coalition_call.acceptance.own_vassal
			scope:recipient = {
				is_vassal_or_below_of = scope:actor
			}
		}
		modifier = { #Already at war # -40
			add = -40
			desc = geroian_coalition_call.acceptance.at_war
			scope:recipient = {
				is_at_war = yes
			}
		}
		modifier = { #Debt # -50
			add = -50
			desc = geroian_coalition_call.acceptance.debt
			scope:recipient = {
				gold < 0
			}
		}
		modifier = { #Liege at war with sender # -75
			add = -75
			desc = geroian_coalition_call.acceptance.liege_at_war
			scope:recipient = {
				is_independent_ruler = no
				top_liege = {
					is_at_war_with = scope:actor
				}
			}
		}
		modifier = { #Rival # -100
			add = -100
			desc = geroian_coalition_call.acceptance.rival
			scope:recipient = {
				OR = {
					has_relation_rival = scope:actor
					has_relation_nemesis = scope:actor
					existing_feud_against_target_trigger = { TARGET = scope:actor }
				}
			}
		}
		modifier = { #Aekekartel faith # -100
			add = -100
			desc = geroian_coalition_call.acceptance.aekekartel
			scope:recipient = {
				has_faith = faith:aekekartel
			}
		}
		modifier = { #Craven # -200
			add = -200
			desc = geroian_coalition_call.acceptance.craven
			scope:recipient = {
				has_trait = craven
			}
		}
		opinion_modifier = { # Opinion positive - factor
			who = scope:recipient
			opinion_target = scope:actor
			multiplier = 0.3
			max = 49
			min = 0
			desc = AI_OPINION_REASON
		}
		opinion_modifier = { # Opinion negative - factor
			who = scope:recipient
			opinion_target = scope:actor
			multiplier = 0.4
			min = -49
			max = 0
			desc = AI_OPINION_REASON
		}
	}
	on_accept = {
		hidden_effect = {
			scope:actor = {
				every_character_war = {
					limit = {
						has_variable = geroian_invasion_var
						NOT = {
							any_war_participant = {
								this = scope:recipient
							}
						}
					}
					save_scope_as = called_geroian_war
				}
				add_opinion = {
					modifier = geroian_defence
					years = 2
					target = scope:recipient
				}
			}
		}
		scope:called_geroian_war = {
			add_defender = scope:recipient
		}
		scope:recipient = {
			if = {
				limit = {
					has_character_modifier = joined_geroian_coalition
				}
				remove_character_modifier = joined_geroian_coalition
			}
			add_character_modifier = {
				modifier = joined_geroian_coalition
				years = 2
			}
		}
	}
	on_decline = {
		scope:recipient = {
			add_prestige = -200
		}
		scope:actor = {
			add_opinion = {
				modifier = geroian_didnt_come_to_my_defence
				years = 5
				target = scope:recipient
			}
		}
	}
}
geroian_coalition_call = {
	category = interaction_category_diplomacy
	desc = geroian_coalition_call
	interface_priority = 90
	common_interaction = yes
	popup_on_receive = yes
	pause_on_receive = yes
	icon = alliance
	greeting = positive
	can_send_despite_rejection = yes
	
	ai_min_reply_days = 1
	ai_max_reply_days = 2
	
	is_shown = {
		scope:actor = {
			has_game_rule = ck_geroian_coalition_enabled
			culture = {
				has_cultural_pillar = heritage_geroian
			}
			is_ai = no
			is_landed = yes
			is_at_war = yes
			any_character_war = {
				has_variable = geroian_invasion_var
			}
		}
		scope:recipient = {
			is_landed = yes
			culture = {
				has_cultural_pillar = heritage_geroian
			}
			top_liege.culture = {
				has_cultural_pillar = heritage_geroian
			}
		}
		scope:actor != scope:recipient
	}
	
	is_valid_showing_failures_only = {
		scope:recipient = {
			NOT = {
				is_at_war_with = scope:actor
			}
			is_imprisoned = no
		}
		custom_tooltip = {
			text = geroian_coalition_already_helping
			scope:actor = {
				any_character_war = {
					has_variable = geroian_invasion_var
					NOT = {
						is_defender = scope:recipient
					}
				}
			}
		}
		
	}
	can_be_picked = {
		NOT = { scope:recipient = root }
	}
	ai_accept = {
		base = 20
		
		modifier = { # 75% of Geroia occupied by foreigners # +100
			add = 1000
			desc = geroian_coalition_call.acceptance.75percent
			any_county_in_region = {
				region = region_geroia
				percent >= 0.75
				holder.top_liege = {
					NOT = {
						culture = {
							has_cultural_pillar = heritage_geroian
						}
					}
				}
			}
		}
		modifier = { # 50% of Geroia occupied by foreigners # +50
			add = 50
			desc = geroian_coalition_call.acceptance.50percent
			any_county_in_region = {
				region = region_geroia
				percent >= 0.5
				holder.top_liege = {
					NOT = {
						culture = {
							has_cultural_pillar = heritage_geroian
						}
					}
				}
			}
			any_county_in_region = {
				region = region_geroia
				percent < 0.75
				holder.top_liege = {
					NOT = {
						culture = {
							has_cultural_pillar = heritage_geroian
						}
					}
				}
			}
		}
		modifier = { # 25% of Geroia occupied by foreigners # +25
			add = 25
			desc = geroian_coalition_call.acceptance.25percent
			any_county_in_region = {
				region = region_geroia
				percent < 0.5
				holder.top_liege = {
					NOT = {
						culture = {
							has_cultural_pillar = heritage_geroian
						}
					}
				}
			}
			any_county_in_region = {
				region = region_geroia
				percent >= 0.25
				holder.top_liege = {
					NOT = {
						culture = {
							has_cultural_pillar = heritage_geroian
						}
					}
				}
			}
		}
		modifier = { #Is theocratic # +50
			add = 50
			desc = geroian_coalition_call.acceptance.theocratic
			scope:recipient = {
				NOT = {
					has_faith = faith:aekekartel
				}
				government_has_flag = government_is_theocracy
			}
		}
		modifier = { #Friends or best friends # +50
			add = 50
			desc = geroian_coalition_call.acceptance.friend_or_best_friend
			scope:recipient = {
				OR = {
					has_relation_friend = scope:actor
					has_relation_best_friend = scope:actor
				}
			}
		}
		modifier = { #Uniting against the Empire # +50
			add = 50
			desc = geroian_coalition_call.acceptance.empire
			exists = title:e_calradian_empire.holder
			scope:actor = {
				is_at_war_with = title:e_calradian_empire.holder
			}
		}
		modifier = { #Traits # +20
			add = 20
			desc = geroian_coalition_call.acceptance.general_traits_accept
			scope:recipient = {
				OR = {
					has_trait = brave
					has_trait = ambitious
					has_trait = loyal
					has_trait = compassionate
					has_trait = zealous
				}
			}
		}
		modifier = { #Opinion above 50 # +20
			add = 20
			desc = geroian_coalition_call.acceptance.good_opinion
			scope:recipient = {
				opinion = {
					target = scope:actor
					value >= 50
				}
			}
		}
		modifier = { #Neighbour # +20
			add = 20
			desc = geroian_coalition_call.acceptance.neighbour
			scope:recipient = {
				NOT = {
					is_vassal_or_below_of = scope:actor
				}
				any_sub_realm_title = {
					is_neighbor_to_realm = scope:actor
				}
			}
		}
		modifier = { #Military more powerful than sender # +15
			add = 15
			desc = geroian_coalition_call.acceptance.military_powerful
			scope:recipient = {
				current_military_strength > scope:actor.current_military_strength
			}
		}
		modifier = { #Weaker military than sender # -10
			add = -10
			desc = geroian_coalition_call.acceptance.military_weak
			scope:recipient = {
				current_military_strength < scope:actor.current_military_strength
			}
		}
		modifier = { #Foreign vassal # -15
			add = -15
			desc = geroian_coalition_call.acceptance.vassal
			scope:recipient = {
				is_independent_ruler = no
				NOT = {
					is_vassal_or_below_of = scope:actor
				}
			}
		}
		modifier = { #Ilegitimate ruler # -20
			add = -20
			desc = geroian_coalition_call.acceptance.low_legitimacy
			scope:actor = {
				legitimacy_level = 0
			}
		}
		modifier = { #General traits # -25
			add = -25
			desc = geroian_coalition_call.acceptance.general_traits_reject
			scope:recipient = {
				OR = {
					has_trait = reclusive
					has_trait = cynical
					has_trait = deceitful
				}
			}
		}
		modifier = { #Negative opinion # -30
			add = -30
			desc = geroian_coalition_call.acceptance.negative_opinion
			scope:recipient = {
				opinion = {
					target = scope:actor
					value <= -50
				}
			}
		}
		modifier = { # Im your vassal/you already take my levies # -30
			add = -30
			desc = geroian_coalition_call.acceptance.own_vassal
			scope:recipient = {
				is_vassal_or_below_of = scope:actor
			}
		}
		modifier = { #Already at war # -40
			add = -40
			desc = geroian_coalition_call.acceptance.at_war
			scope:recipient = {
				is_at_war = yes
			}
		}
		modifier = { #Debt # -50
			add = -50
			desc = geroian_coalition_call.acceptance.debt
			scope:recipient = {
				gold < 0
			}
		}
		modifier = { #Liege at war with sender # -75
			add = -75
			desc = geroian_coalition_call.acceptance.liege_at_war
			scope:recipient = {
				is_independent_ruler = no
				top_liege = {
					is_at_war_with = scope:actor
				}
			}
		}
		modifier = { #Rival # -100
			add = -100
			desc = geroian_coalition_call.acceptance.rival
			scope:recipient = {
				OR = {
					has_relation_rival = scope:actor
					has_relation_nemesis = scope:actor
					existing_feud_against_target_trigger = { TARGET = scope:actor }
				}
			}
		}
		modifier = { #Aekekartel faith # -100
			add = -100
			desc = geroian_coalition_call.acceptance.aekekartel
			scope:recipient = {
				has_faith = faith:aekekartel
			}
		}
		modifier = { #Craven # -200
			add = -200
			desc = geroian_coalition_call.acceptance.craven
			scope:recipient = {
				has_trait = craven
			}
		}
		opinion_modifier = { # Opinion positive - factor
			who = scope:recipient
			opinion_target = scope:actor
			multiplier = 0.3
			max = 49
			min = 0
			desc = AI_OPINION_REASON
		}
		opinion_modifier = { # Opinion negative - factor
			who = scope:recipient
			opinion_target = scope:actor
			multiplier = 0.4
			min = -49
			max = 0
			desc = AI_OPINION_REASON
		}
	}
	on_accept = {
		hidden_effect = {
			scope:actor = {
				every_character_war = {
					limit = {
						has_variable = geroian_invasion_var
						NOT = {
							any_war_participant = {
								this = scope:recipient
							}
						}
					}
					save_scope_as = called_geroian_war
				}
				add_opinion = {
					modifier = geroian_defence
					years = 2
					target = scope:recipient
				}
				trigger_event = ck_geroian_events.0003
			}
		}
		scope:called_geroian_war = {
			add_defender = scope:recipient
		}
		scope:recipient = {
			hidden_effect = {
				if = {
					limit = {
						has_character_modifier = joined_geroian_coalition
					}
					remove_character_modifier = joined_geroian_coalition
				}
				add_character_modifier = {
					modifier = joined_geroian_coalition
					years = 2
				}
			}
		}
	}
	on_decline = {
		scope:recipient = {
			add_prestige = -200
		}
		scope:actor = {
			add_opinion = {
				modifier = geroian_didnt_come_to_my_defence
				years = 4
				target = scope:recipient
			}
			trigger_event = ck_geroian_events.0004
		}
	}
}

### Realm Law Interactions ###
## Religious Tolerance ##
# No Tolerance #
## Decommissioned this interaction for now. I want only independent rulers the chance to take this
# demand_realm_law_tolerance = {
# 	category = interaction_category_vassal
# 	interface_priority = 110
# 	icon = council
# 	desc = demand_realm_law_tolerance_desc
# 	common_interaction = yes

# 	popup_on_receive = yes
# 	pause_on_receive = yes

# 	ai_min_reply_days = 1
# 	ai_max_reply_days = 7
	
# 	cooldown_against_recipient = { months = 12 } 

# 	is_shown = {
# 		scope:recipient = {
# 			faith = {
# 				this = scope:actor.faith
# 			}
# 			highest_held_title_tier >= tier_duchy
# 		}
# 		OR = {
# 			AND = {
# 				scope:actor = {
# 					has_realm_law_flag = persecuted_tolerance
# 					is_liege_or_above_of = scope:recipient
# 				}
# 				scope:recipient = {
# 					is_vassal_or_below_of = scope:actor
# 					OR = {
# 						has_realm_law_flag = normal_religious_tolerance
# 						has_realm_law_flag = full_religious_tolerance
# 					}
# 					faith = {
# 						NOT = {
# 							ck_syncretic_faiths_trigger = yes
# 						}
# 					}
# 				}
# 			}
# 			AND = {
# 				scope:actor = {
# 					has_realm_law_flag = full_religious_tolerance
# 					is_liege_or_above_of = scope:recipient
# 				}
# 				scope:recipient = {
# 					is_vassal_or_below_of = scope:actor
# 					OR = {
# 						has_realm_law_flag = can_tax_other_faiths_ck
# 						has_realm_law_flag = persecuted_tolerance
# 					}
# 				}
# 			}
# 		}
# 	}

# 	is_valid_showing_failures_only = {
# 		scope:recipient = {
# 			NOT = {
# 				is_at_war_with = scope:actor
# 			}
# 			is_imprisoned = no
# 			is_vassal_or_below_of = scope:actor
# 			faith = {
# 				this = scope:actor.faith
# 			}
# 		}
# 	}

# 	can_be_picked = {
# 		NOT = { scope:recipient = root }
# 	}

# 	can_send = {
# 		scope:actor = {
# 			custom_description = {
# 				text = "character_interactions_hostile_actions_disabled_delay"
# 				NOT = { has_character_flag = flag_hostile_actions_disabled_delay }
# 			}
# 		}
# 	}
# 	send_option = {
# 		flag = demanded_for_persecution
# 		is_valid = {
# 			AND = {
# 				scope:actor = {
# 					has_realm_law_flag = persecuted_tolerance
# 					is_liege_or_above_of = scope:recipient
# 				}
# 				scope:recipient = {
# 					is_vassal_or_below_of = scope:actor
# 					OR = {
# 						has_realm_law_flag = normal_religious_tolerance
# 						has_realm_law_flag = full_religious_tolerance
# 					}
# 					faith = {
# 						this = scope:actor.faith
# 					}
# 				}
# 			}
# 		}
# 	}

# 	send_option = {
# 		flag = demanded_for_full_rights
# 		is_valid = {
# 			AND = {
# 				scope:actor = {
# 					has_realm_law_flag = full_religious_tolerance
# 					is_liege_or_above_of = scope:recipient
# 				}
# 				scope:recipient = {
# 					is_vassal_or_below_of = scope:actor
# 					OR = {
# 						has_realm_law_flag = can_tax_other_faiths_ck
# 						has_realm_law_flag = persecuted_tolerance
# 					}
# 					faith = {
# 						this = scope:actor.faith
# 					}
# 				}
# 			}
# 		}
# 	}

# 	ai_accept = {
# 		base = -25

# 		modifier = {
# 			add = 30
# 			desc = invite_to_expedition.acceptance.friend_or_best_friend
# 			scope:recipient = {
# 				OR = {
# 					has_relation_friend = scope:actor
# 					has_relation_best_friend = scope:actor
# 				}
# 			}
# 		}
# 		modifier = { #Opinion above 50 # +20
# 			add = 20
# 			desc = invite_to_expedition.acceptance.good_opinion
# 			scope:recipient = {
# 				opinion = {
# 					target = scope:actor
# 					value >= 50
# 				}
# 			}
# 		}
# 		modifier = { #Is loyal # +20
# 			add = 20
# 			desc = invite_to_expedition.acceptance.loyal
# 			scope:recipient = {
# 				has_trait = loyal
# 			}
# 		}

# 		## Demand Persecution
# 		modifier = {
# 			add = 50
# 			desc = demand_realm_law_tolerance_zealot_no
# 			scope:recipient = {
# 				OR = {
# 					has_vassal_stance = zealot
# 					has_trait = zealous
# 				}
# 			}
# 			scope:demanded_for_persecution?= yes
# 		}
# 		modifier = {
# 			add = -50
# 			desc = demand_realm_law_against_doctrine_pluralism
# 			scope:recipient = {
# 				faith = {
# 					has_doctrine = doctrine_pluralism_pluralistic
# 				}
# 			}
# 		}
# 		modifier = {
# 			add = -20
# 			desc = demand_realm_law_tolerance_cynical
# 			scope:recipient = {
# 				has_trait = cynical
# 			}
# 			scope:demanded_for_persecution?= yes
# 		}

# 		## Demand Full Rights
# 		modifier = {
# 			add = -50
# 			desc = demand_realm_law_tolerance_zealot_no
# 			scope:recipient = {
# 				OR = {
# 					has_vassal_stance = zealot
# 					has_trait = zealous
# 				}
# 			}
# 			scope:demanded_for_full_rights?= yes
# 		}

# 		# Dread
# 		## Intimidation
# 		modifier = {
# 			add = intimidated_halved_reason_value
# 			desc = INTIMIDATED_REASON
# 			scope:recipient = {
# 				has_dread_level_towards = {
# 					target = scope:actor
# 					level = 1
# 				}
# 			}
# 		}
# 		## Cowing
# 		modifier = {
# 			add = cowed_halved_reason_value
# 			desc = COWED_REASON
# 			scope:recipient = {
# 				has_dread_level_towards = {
# 					target = scope:actor
# 					level = 2
# 				}
# 			}
# 		}
# 		# Comparative military strength.
# 		modifier = {
# 			add = {
# 				value = 1
# 					subtract = {
# 						value = scope:recipient.max_military_strength
# 						divide = { value = scope:actor.max_military_strength min = 1 }
# 					}
# 				multiply = 50
# 				max = 20
# 			}
# 			desc = offer_vassalization_interaction_aibehavior_power_tt
# 			scope:actor = { is_landed_or_landless_administrative = yes }
# 		}
# 	}

# 	on_accept = {
# 		scope:actor = {
# 			switch = {
# 				trigger = yes
# 				scope:demanded_for_persecution ?= {
# 					scope:recipient = {
# 						custom_tooltip = {
# 							text = will_change_law_to_persecution
# 							add_realm_law_skip_effects = ck_religious_tolerance_0
# 						}
# 						if = {
# 							limit = {
# 								faith = {
# 									has_doctrine = doctrine_pluralism_pluralistic
# 								}
# 							}
# 							add_piety = -50
# 						}
# 					}
# 					scope:actor = {
# 						if = {
# 							limit = {
# 								faith = {
# 									has_doctrine = doctrine_pluralism_pluralistic
# 								}
# 							}
# 							add_piety = -100
# 						}
# 					}
# 				}
# 				scope:demanded_for_full_rights ?= {
# 					scope:recipient = {
# 						if = {
# 							limit = {
# 								has_realm_law_flag = can_tax_other_faiths_ck
# 								any_vassal = {
# 									vassal_contract_obligation_level_can_be_decreased = jizya_special_rights
# 								}
# 							}
# 							every_vassal = {
# 								limit = {
# 									vassal_contract_obligation_level_can_be_decreased = jizya_special_rights
# 								}
# 								vassal_contract_set_obligation_level = { type = jizya_special_rights level = 0 }
# 							}
# 						}
# 						if = {
# 							limit = {
# 								faith = {
# 									has_doctrine = doctrine_pluralism_pluralistic
# 								}
# 							}
# 							custom_tooltip = {
# 								text = will_change_law_to_full
# 								add_realm_law_skip_effects = ck_religious_tolerance_3
# 							}
# 						}
# 						else_if = {
# 							limit = {
# 								faith = {
# 									NOT = {
# 										has_doctrine = doctrine_pluralism_pluralistic
# 									}
# 								}
# 							}
# 							custom_tooltip = {
# 								text = will_change_law_to_tolerated
# 								add_realm_law_skip_effects = ck_religious_tolerance_2
# 							}
# 						}
# 					}
# 					scope:actor = {
# 						if = {
# 							limit = {
# 								faith = {
# 									has_doctrine = doctrine_pluralism_pluralistic
# 								}
# 							}
# 							add_piety = 50
# 						}
# 						else_if = {
# 							limit = {
# 								faith = {
# 									OR = {
# 										has_doctrine = doctrine_pluralism_fundamentalist
# 										has_doctrine = doctrine_pluralism_righteous
# 									}
# 								}
# 							}
# 							add_piety = -100
# 						}
# 					}
# 				}
# 			}
# 		}

# 	}
# 	on_decline = {
# 		scope:actor = {
# 			switch = {
# 				trigger = yes
# 				scope:demanded_for_persecution ?= {
# 					scope:recipient = {
# 						if = {
# 							limit = {
# 								scope:actor = {
# 									faith = {
# 										NOT = {
# 											has_doctrine = doctrine_pluralism_pluralistic
# 										}
# 									}
# 								}
# 								scope:recipient = {
# 									NOT = {
# 										vassal_contract_has_flag = vassal_contract_cannot_revoke_titles
# 									}
# 								}
# 							}
# 							custom_tooltip = {
# 								text = demand_realm_law_tolerance_lawful_imprisonment
# 								add_opinion = {
# 									target = scope:recipient
# 									modifier = ck_religious_tolerance_refused_change
# 								}
# 							}
# 						}
# 						if = {
# 							limit = {
# 								faith = {
# 									has_doctrine = doctrine_pluralism_pluralistic
# 								}
# 							}
# 							add_piety = 50
# 						}
# 						add_opinion = {
# 							target = scope:actor
# 							modifier = ck_religious_tolerance_refused_change_me
# 						}
# 					}
# 					scope:actor = {
# 						if = {
# 							limit = {
# 								faith = {
# 									OR = {
# 										has_doctrine = doctrine_pluralism_fundamentalist
# 										has_doctrine = doctrine_pluralism_righteous
# 									}
# 								}
# 							}
# 							add_legitimacy_effect = { LEGITIMACY = miniscule_legitimacy_loss }
# 						}
# 					}
# 				}
# 				scope:demanded_for_full_rights ?= {
# 					scope:recipient = {
# 						if = {
# 							limit = {
# 								faith = {
# 									has_doctrine = doctrine_pluralism_pluralistic
# 								}
# 							}
# 							custom_tooltip = {
# 								text = will_change_law_to_full
# 								add_realm_law_skip_effects = ck_religious_tolerance_3
# 							}
# 						}
# 						else_if = {
# 							limit = {
# 								faith = {
# 									NOT = {
# 										has_doctrine = doctrine_pluralism_pluralistic
# 									}
# 								}
# 							}
# 							custom_tooltip = {
# 								text = will_change_law_to_tolerated
# 								add_realm_law_skip_effects = ck_religious_tolerance_2
# 							}
# 						}
# 					}
# 					scope:actor = {
# 						if = {
# 							limit = {
# 								faith = {
# 									has_doctrine = doctrine_pluralism_pluralistic
# 								}
# 							}
# 							add_piety = -50
# 						}
# 						else_if = {
# 							limit = {
# 								faith = {
# 									OR = {
# 										has_doctrine = doctrine_pluralism_fundamentalist
# 										has_doctrine = doctrine_pluralism_righteous
# 									}
# 								}
# 							}
# 							add_piety = -100
# 						}
# 					}
# 				}
# 			}
# 		}
# 	}

# 	ai_potential = {
# 		is_adult = yes
# 		scope:recipient = {
# 			highest_held_title_tier >= tier_duchy
# 		}
# 	}
# 	ai_will_do = {
# 		base = 0

# 		modifier = {
# 			add = 100
# 			OR = {
# 				AND = {
# 					scope:actor = {
# 						ai_zeal < 30
# 						has_realm_law_flag = persecuted_tolerance
# 						is_liege_or_above_of = scope:recipient
# 						faith = {
# 							NOT = {
# 								has_doctrine = doctrine_pluralism_pluralistic
# 							}
# 						}
# 					}
# 					scope:recipient = {
# 						is_vassal_or_below_of = scope:actor
# 						OR = {
# 							has_realm_law_flag = normal_religious_tolerance
# 							has_realm_law_flag = full_religious_tolerance
# 						}
# 					}
# 				}
# 				AND = {
# 					scope:actor = {
# 						ai_zeal < 15
# 						has_realm_law_flag = full_religious_tolerance
# 						is_liege_or_above_of = scope:recipient
# 						faith = {
# 							has_doctrine = doctrine_pluralism_pluralistic
# 						}
# 					}
# 					scope:recipient = {
# 						is_vassal_or_below_of = scope:actor
# 						OR = {
# 							has_realm_law_flag = can_tax_other_faiths_ck
# 							has_realm_law_flag = persecuted_tolerance
# 						}
# 					}
# 				}
# 			}
# 		}

# 		modifier = {
# 			add = 15
			
# 			OR = {
# 				AND = {
# 					scope:actor = {
# 						ai_zeal > 20
# 						has_realm_law_flag = persecuted_tolerance
# 						is_liege_or_above_of = scope:recipient
# 						faith = {
# 							has_doctrine = doctrine_pluralism_pluralistic
# 						}
# 					}
# 					scope:recipient = {
# 						is_vassal_or_below_of = scope:actor
# 						OR = {
# 							has_realm_law_flag = normal_religious_tolerance
# 							has_realm_law_flag = full_religious_tolerance
# 						}
# 					}
# 				}
# 				AND = {
# 					scope:actor = {
# 						ai_zeal > 15
# 						has_realm_law_flag = full_religious_tolerance
# 						is_liege_or_above_of = scope:recipient
# 						faith = {
# 							NOT = {
# 								has_doctrine = doctrine_pluralism_pluralistic
# 							}
# 						}
# 					}
# 					scope:recipient = {
# 						is_vassal_or_below_of = scope:actor
# 						OR = {
# 							has_realm_law_flag = can_tax_other_faiths_ck
# 							has_realm_law_flag = persecuted_tolerance
# 						}
# 					}
# 				}
# 			}
# 		}
# 	}

# 	auto_accept = {
# 		scope:demanded_for_persecution = no
# 		scope:demanded_for_full_rights = no
# 	}
# 	ai_frequency = 18
# }